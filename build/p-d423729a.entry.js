import{r as t,c as e,h as i,g as s}from"./p-c9ba45b0.js";import{b as a,t as n}from"./p-1631d2a0.js";import{c as l,u as o,d as r,I as c}from"./p-c09dab4d.js";import{c as h}from"./p-3f298b29.js";import{M as d}from"./p-0034828c.js";import{u as f,g as u}from"./p-e3835546.js";import{d as b,a as p,c as m}from"./p-70fe0c9e.js";import{S as v}from"./p-61fdc336.js";import{a as g,s as I,c as y}from"./p-774fbe58.js";import{c as k,s as C,d as L,u as x}from"./p-3c05e9bf.js";import{n as S}from"./p-909ebb2d.js";import{d as E}from"./p-58421494.js";import"./p-ab6a0f88.js";import"./p-25d4ba13.js";import"./p-28de0941.js";import"./p-6ceba8f9.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.8.0
 */const D={container:"container",table:"table",scrim:"scrim",stack:"stack",tableContainer:"table-container",sticky:"sticky-pos",assistiveText:"assistive-text"};const j=0;const w={filterNoResults:"filter-no-results",filterActionsStart:"filter-actions-start",filterActionsEnd:"filter-actions-end"};const F=":host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:block}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.container{position:relative}.table-container{box-sizing:border-box;display:flex;inline-size:100%;flex-direction:column;background-color:transparent}.table-container *{box-sizing:border-box}.table{inline-size:100%;border-collapse:collapse}.stack{--calcite-stack-padding-inline:0;--calcite-stack-padding-block:0}.sticky-pos{position:sticky;inset-block-start:0px;z-index:var(--calcite-z-index-sticky);background-color:var(--calcite-color-foreground-1)}.sticky-pos th{padding:0px}.assistive-text{position:absolute;inline-size:1px;block-size:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}:host([hidden]){display:none}[hidden]{display:none}";const A="calcite-list-item";const T=`:scope > calcite-list-item`;const M="calcite-list-item-group, calcite-list-item";const z=class{constructor(i){t(this,i);this.calciteListChange=e(this,"calciteListChange",6);this.calciteListDragEnd=e(this,"calciteListDragEnd",6);this.calciteListDragStart=e(this,"calciteListDragStart",6);this.calciteListFilter=e(this,"calciteListFilter",6);this.calciteListOrderChange=e(this,"calciteListOrderChange",6);this.calciteInternalListDefaultSlotChange=e(this,"calciteInternalListDefaultSlotChange",6);this.dragSelector=A;this.focusableItems=[];this.handleSelector="calcite-handle";this.listItems=[];this.mutationObserver=h("mutation",(()=>this.updateListItems()));this.visibleItems=[];this.handleDefaultSlotChange=t=>{f(u(t.target));if(this.parentListEl){this.calciteInternalListDefaultSlotChange.emit()}};this.handleFilterActionsStartSlotChange=t=>{this.hasFilterActionsStart=a(t)};this.handleFilterActionsEndSlotChange=t=>{this.hasFilterActionsEnd=a(t)};this.handleFilterNoResultsSlotChange=t=>{this.hasFilterNoResults=a(t)};this.setActiveListItem=()=>{const{focusableItems:t}=this;if(!t.some((t=>t.active))){if(t[0]){t[0].active=true}}};this.updateSelectedItems=(t=false)=>{this.selectedItems=this.visibleItems.filter((t=>t.selected));if(t){this.calciteListChange.emit()}};this.borderItems=()=>{const t=this.visibleItems.filter((t=>!t.filterHidden&&this.allParentListItemsOpen(t)));t.forEach((e=>e.bordered=e!==t[t.length-1]))};this.updateFilteredItems=(t=false)=>{const{visibleItems:e,filteredData:i,filterText:s}=this;const a=i.map((t=>t.value));const n=e===null||e===void 0?void 0:e.filter((t=>e.every((e=>e===t||!t.contains(e)))));const l=e.filter((t=>!s||a.includes(t.value)))||[];const o=new WeakSet;n.forEach((t=>this.filterElements({el:t,filteredItems:l,visibleParents:o})));this.filteredItems=l;if(t){this.calciteListFilter.emit()}};this.setFilterEl=t=>{this.filterEl=t;this.performFilter()};this.handleFilterChange=t=>{t.stopPropagation();const{value:e}=t.currentTarget;this.filterText=e;this.updateFilteredData(true)};this.getItemData=()=>this.listItems.map((t=>({label:t.label,description:t.description,metadata:t.metadata,value:t.value})));this.updateListItems=E(((t=false)=>{const{selectionAppearance:e,selectionMode:i,dragEnabled:s}=this;const a=this.queryListItems();a.forEach((t=>{t.selectionAppearance=e;t.selectionMode=i}));const n=this.queryListItems(true);n.forEach((t=>{t.dragHandle=s}));if(!!this.parentListEl){this.setUpSorting();return}this.listItems=a;if(this.filterEnabled){this.dataForFilter=this.getItemData();if(this.filterEl){this.filterEl.items=this.dataForFilter}}this.visibleItems=this.listItems.filter((t=>!t.closed&&!t.hidden));this.updateFilteredItems(t);this.borderItems();this.focusableItems=this.filteredItems.filter((t=>!t.disabled));this.setActiveListItem();this.updateSelectedItems(t);this.setUpSorting()}),j);this.queryListItems=(t=false)=>Array.from(this.el.querySelectorAll(t?T:A));this.focusRow=t=>{const{focusableItems:e}=this;if(!t){return}e.forEach((e=>e.active=e===t));t.setFocus()};this.isNavigable=t=>{var e;const i=(e=t.parentElement)===null||e===void 0?void 0:e.closest(A);if(!i){return true}return i.open&&this.isNavigable(i)};this.handleListKeydown=t=>{var e;if(t.defaultPrevented||!!this.parentListEl){return}const{key:i}=t;const s=this.focusableItems.filter((t=>this.isNavigable(t)));const a=s.findIndex((t=>t.active));if(i==="ArrowDown"){t.preventDefault();const e=t.target===this.filterEl?0:a+1;if(s[e]){this.focusRow(s[e])}}else if(i==="ArrowUp"){t.preventDefault();if(a===0&&this.filterEnabled){(e=this.filterEl)===null||e===void 0?void 0:e.setFocus();return}const i=a-1;if(s[i]){this.focusRow(s[i])}}else if(i==="Home"){t.preventDefault();const e=s[0];if(e){this.focusRow(e)}}else if(i==="End"){t.preventDefault();const e=s[s.length-1];if(e){this.focusRow(e)}}};this.disabled=false;this.canPull=undefined;this.canPut=undefined;this.dragEnabled=false;this.group=undefined;this.filterEnabled=false;this.filteredItems=[];this.filteredData=[];this.filterPlaceholder=undefined;this.filterText=undefined;this.label=undefined;this.loading=false;this.messageOverrides=undefined;this.messages=undefined;this.numberingSystem=undefined;this.openable=false;this.selectedItems=[];this.selectionMode="none";this.selectionAppearance="icon";this.effectiveLocale="";this.defaultMessages=undefined;this.assistiveText=undefined;this.dataForFilter=[];this.hasFilterActionsEnd=false;this.hasFilterActionsStart=false;this.hasFilterNoResults=false}async handleFilterTextChange(){this.performFilter()}onMessagesChange(){}handleListItemChange(){this.updateListItems()}handleCalciteListItemToggle(){if(this.parentListEl){return}this.borderItems()}handleCalciteInternalFocusPreviousItem(t){if(this.parentListEl){return}t.stopPropagation();const{focusableItems:e}=this;const i=e.findIndex((t=>t.active));const s=i-1;if(e[s]){this.focusRow(e[s])}}handleCalciteInternalListItemActive(t){if(!!this.parentListEl){return}t.stopPropagation();const e=t.target;const{listItems:i}=this;i.forEach((t=>{t.active=t===e}))}handleCalciteListItemSelect(){if(!!this.parentListEl){return}this.updateSelectedItems(true)}handleCalciteInternalAssistiveTextChange(t){this.assistiveText=t.detail.message;t.stopPropagation()}handleCalciteHandleNudge(t){if(!!this.parentListEl){return}this.handleNudgeEvent(t)}handleCalciteInternalListItemSelect(t){if(!!this.parentListEl){return}t.stopPropagation();const e=t.target;const{listItems:i,selectionMode:s}=this;if(e.selected&&(s==="single"||s==="single-persist")){i.forEach((t=>t.selected=t===e))}this.updateSelectedItems()}handleCalciteInternalListItemSelectMultiple(t){if(!!this.parentListEl){return}t.stopPropagation();const{target:e,detail:i}=t;const{focusableItems:s,lastSelectedInfo:a}=this;const n=e;if(i.selectMultiple&&!!a){const t=s.indexOf(n);const e=s.indexOf(a.selectedItem);const i=Math.min(e,t);const l=Math.max(e,t);s.slice(i,l+1).forEach((t=>t.selected=a.selected))}else{this.lastSelectedInfo={selectedItem:n,selected:n.selected}}}handleCalciteInternalListItemChange(t){if(!!this.parentListEl){return}t.stopPropagation();this.updateListItems()}handleCalciteInternalListItemGroupDefaultSlotChange(t){t.stopPropagation()}connectedCallback(){if(b(this)){return}k(this);this.connectObserver();this.updateListItems();this.setUpSorting();l(this);this.setParentList()}async componentWillLoad(){g(this);await C(this)}componentDidRender(){o(this)}componentDidLoad(){I(this)}disconnectedCallback(){if(b(this)){return}this.disconnectObserver();p(this);r(this);L(this)}effectiveLocaleChange(){x(this,this.effectiveLocale)}async setFocus(){var t,e;await y(this);if(this.filterEnabled){return(t=this.filterEl)===null||t===void 0?void 0:t.setFocus()}return(e=this.focusableItems.find((t=>t.active)))===null||e===void 0?void 0:e.setFocus()}render(){const{loading:t,label:e,disabled:s,dataForFilter:a,filterEnabled:l,filterPlaceholder:o,filterText:r,filteredItems:h,hasFilterActionsStart:f,hasFilterActionsEnd:u,hasFilterNoResults:b}=this;return i(c,{key:"be7d5300b720d3c2adb29ee3dec27d7b70c3e0b4",disabled:this.disabled},i("div",{key:"1c6ff5516994d00848c331174d07ab4c7a70d5a1",class:D.container},this.dragEnabled?i("span",{"aria-live":"assertive",class:D.assistiveText},this.assistiveText):null,this.renderItemAriaLive(),t?i("calcite-scrim",{class:D.scrim,loading:t}):null,i("table",{key:"78bfe1d34ec213e8f0c5494784298ff67d39ec8c","aria-busy":n(t),"aria-label":e||"",class:D.table,onKeyDown:this.handleListKeydown,role:"treegrid"},l||f||u?i("thead",{class:D.sticky},i("tr",null,i("th",{colSpan:d},i("calcite-stack",{class:D.stack},i("slot",{name:w.filterActionsStart,onSlotchange:this.handleFilterActionsStartSlotChange,slot:v.actionsStart}),i("calcite-filter",{"aria-label":o,disabled:s,items:a,onCalciteFilterChange:this.handleFilterChange,placeholder:o,value:r,ref:this.setFilterEl}),i("slot",{name:w.filterActionsEnd,onSlotchange:this.handleFilterActionsEndSlotChange,slot:v.actionsEnd}))))):null,i("tbody",{key:"8950cb148789530e6dad16a722c7c6077b2a5ab8",class:D.tableContainer},i("slot",{key:"a8333193d984d6534f5861a1cee0cd98744573b6",onSlotchange:this.handleDefaultSlotChange}))),i("div",{key:"2b96f30d61ac1d33e6709afe93ce259b61d1ab67","aria-live":"polite","data-test-id":"no-results-container",hidden:!(b&&l&&r&&!h.length)},i("slot",{key:"12c5d5758a840ef8eb9cbc5df36b73ec7a8f3c94",name:w.filterNoResults,onSlotchange:this.handleFilterNoResultsSlotChange}))))}renderItemAriaLive(){const{messages:t,filteredItems:e,parentListEl:s,effectiveLocale:a,numberingSystem:n,filterEnabled:l,filterText:o,filteredData:r}=this;S.numberFormatOptions={locale:a,numberingSystem:n};return!s?i("div",{"aria-live":"polite",class:D.assistiveText},l&&o&&(r===null||r===void 0?void 0:r.length)?i("div",{key:"aria-filter-enabled"},t.filterEnabled):null,i("div",{key:"aria-item-count"},t.total.replace("{count}",S.localize(e.length.toString()))),e.length?i("ol",{key:"aria-item-list"},e.map((t=>i("li",null,t.label)))):null):null}connectObserver(){var t;(t=this.mutationObserver)===null||t===void 0?void 0:t.observe(this.el,{childList:true,subtree:true})}disconnectObserver(){var t;(t=this.mutationObserver)===null||t===void 0?void 0:t.disconnect()}setUpSorting(){const{dragEnabled:t}=this;if(!t){return}m(this)}onGlobalDragStart(){this.disconnectObserver()}onGlobalDragEnd(){this.connectObserver()}onDragEnd(t){this.calciteListDragEnd.emit(t)}onDragStart(t){this.calciteListDragStart.emit(t)}onDragSort(t){this.setParentList();this.updateListItems();this.calciteListOrderChange.emit(t)}setParentList(){var t;this.parentListEl=(t=this.el.parentElement)===null||t===void 0?void 0:t.closest("calcite-list")}filterElements({el:t,filteredItems:e,visibleParents:i}){const s=!i.has(t)&&!e.includes(t);t.filterHidden=s;const a=t.parentElement.closest(M);if(!a){return}if(!s){i.add(a)}this.filterElements({el:a,filteredItems:e,visibleParents:i})}allParentListItemsOpen(t){var e;const i=(e=t.parentElement)===null||e===void 0?void 0:e.closest(A);if(!i){return true}else if(!i.open){return false}return this.allParentListItemsOpen(i)}updateFilteredData(t=false){const{filterEl:e}=this;if(!e){return}if(e.filteredItems){this.filteredData=e.filteredItems}this.updateListItems(t)}async performFilter(){const{filterEl:t,filterText:e}=this;if(!t){return}t.value=e;await t.filter(e);this.updateFilteredData()}handleNudgeEvent(t){const{handleSelector:e,dragSelector:i}=this;const{direction:s}=t.detail;const a=t.composedPath();const n=a.find((t=>(t===null||t===void 0?void 0:t.tagName)&&t.matches(e)));const l=a.find((t=>(t===null||t===void 0?void 0:t.tagName)&&t.matches(i)));const o=l===null||l===void 0?void 0:l.parentElement;if(!o){return}const{filteredItems:r}=this;const c=r.filter((t=>t.parentElement===o));const h=c.length-1;const d=c.indexOf(l);let f;if(s==="up"){f=d===0?h:d-1}else{f=d===h?0:d+1}this.disconnectObserver();n.blurUnselectDisabled=true;const u=s==="up"&&f!==h||s==="down"&&f===0?c[f]:c[f].nextSibling;o.insertBefore(l,u);this.updateListItems();this.connectObserver();this.calciteListOrderChange.emit({dragEl:l,fromEl:o,toEl:o,newIndex:f,oldIndex:d});n.setFocus().then((()=>n.blurUnselectDisabled=false))}static get assetsDirs(){return["assets"]}get el(){return s(this)}static get watchers(){return{filterText:["handleFilterTextChange"],messageOverrides:["onMessagesChange"],filterEnabled:["handleListItemChange"],group:["handleListItemChange"],dragEnabled:["handleListItemChange"],selectionMode:["handleListItemChange"],selectionAppearance:["handleListItemChange"],effectiveLocale:["effectiveLocaleChange"]}}};z.style=F;export{z as calcite_list};
//# sourceMappingURL=p-d423729a.entry.js.map