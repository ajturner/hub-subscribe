import{g as e}from"./p-3904125b.js";import{c as t,g as a}from"./p-a0deb8c6.js";import{g as r}from"./p-30a7cbb2.js";import{a as i,i as o,g as n}from"./p-90dc0f6f.js";import{e as l,f as c,h as s,i as p,j as u,d,k as g,l as m,a as f,D as b,p as v,g as y,c as k,m as S}from"./p-dd26efbb.js";import{d as D,i as h}from"./p-b728aff4.js";import{p as P}from"./p-6dcae6cd.js";import{g as w}from"./p-796574a4.js";const{app:M,feedback:A}=t,j=["360 VR Experience","Application","CityEngine Web Scene","Code Sample","CSV Collection","CSV","CAD Drawing","Desktop Application","Desktop Application Template","Desktop Style","File Geodatabase","GeoJson","Geoprocessing Package","Geoprocessing Sample","Image","iWork Keynote","iWork Numbers","KML Collection","KML","Layer","Layer File","Layer Package","Layout","Locator Package","Map Package","Map Service Definition","Map Template","Microsoft Excel","Microsoft Powerpoint","Microsoft Visio","Microsoft Word","Notebook","Operations Dashboard Add In","PDF","Pro Map","Project Package","Project Template","Raster function template","Rule Package","Service Definition","Shapefile","Vector Tile Package","Workflow Manager Package"],T=["Data"];M.concat(A);const C=(e,t,a,r)=>!m(e,r)&&t&&a&&a.length>1&&!E(e.url);var I;!function(e){e.Continual="continual",e.Daily="daily",e.Weekly="weekly",e.Fortnightly="fortnightly",e.Monthly="monthly",e.Quarterly="quarterly",e.Biannually="biannually",e.Annually="annually",e.AsNeeded="as-needed",e.Irregular="irregular",e.NotPlanned="not-planned",e.Unknown="unknown",e.Semimonthly="semimonthly"}(I||(I={}));const L=(e,t)=>({"001":I.Continual,"002":I.Daily,"003":I.Weekly,"004":I.Fortnightly,"005":I.Monthly,"006":I.Quarterly,"007":I.Biannually,"008":I.Annually,"009":I.AsNeeded,"010":I.Irregular,"011":I.NotPlanned,"012":I.Unknown,"013":I.Semimonthly}[s(e,t||"updateFrequency")]),x=(e,t)=>{const a=v(s(e,t));return a&&Object.assign(Object.assign({},a),{source:`metadata.${S(t)}`})},W=(e,t)=>{const a=`${t}.editingInfo.lastEditDate`,r=w(e,a);return r&&{date:new Date(r),source:a,precision:b.Day}},$=(e,t)=>({date:new Date(e[t]),precision:b.Day,source:`item.${t}`}),U=e=>{var t;return null!==(t={appbuilderExtension:"file",appbuilderWidgetPackage:"widgets-source",application:"web",applicationConfiguration:"app-gear",arcgisProMap:"desktop",cadDrawing:"file-cad",cityEngineWebScene:"urban-model",codeAttachment:"file-code",codeSample:"file-code",colorSet:"palette",contentCategorySet:"label",csv:"file-csv",cSV:"file-csv",cSVCollection:"file-csv",dashboard:"dashboard",desktopApplication:"desktop",discussion:"speech-bubbles",documentLink:"link",excaliburImageryProject:"file",explorerMap:"file",exportPackage:"file",featureCollection:"data",featureCollectionTemplate:"file",featureLayer:"data",featureService:"collection",fileGeodatabase:"data",form:"survey",geocodingService:"file",geodataService:"file",geometryService:"file",geopackage:"file",geoprocessingService:"file",globeLayer:"layers",globeService:"file",group:"users",hubInitiative:"initiative",hubInitiativeTemplate:"initiative-template",hubPage:"browser",hubProject:"projects",hubSiteApplication:"web",image:"file-image",imageService:"data",insightsModel:"file",insightsPage:"graph-moving-average",insightsTheme:"palette",insightsWorkbook:"graph-moving-average",iWorkPages:"file-text",iWorkKeynote:"presentation",iWorkNumbers:"file-report",kML:"data",kMLCollection:"data",layer:"layers",layerPackage:"layers",layerTemplate:"file",locatorPackage:"file",mapArea:"file",mapDocument:"map-contents",mapImageLayer:"collection",mapPackage:"file",mapService:"collection",microsoftExcel:"file-report",microsoftPowerpoint:"presentation",microsoftWord:"file-text",mission:"file",mobileMapPackage:"map-contents",nativeApplication:"mobile",nativeApplicationInstaller:"file",nativeApplicationTemplate:"file",mobileApplication:"mobile",networkAnalysisService:"file",notebook:"code",orientedImageryCatalog:"file",orthoMappingProject:"file",orthoMappingTemplate:"file",pDF:"file-pdf",quickCaptureProject:"mobile",rasterFunctionTemplate:"file",rasterLayer:"map",realTimeAnalytic:"file",relationalDatabaseConnection:"file",reportTemplate:"file",sceneLayer:"data",sceneService:"urban-model",serviceDefinition:"file",shapefile:"data",solution:"puzzle-piece",sqliteGeodatabase:"file",statisticalDataCollection:"file",storymap:"tour",storyMap:"tour",storymapTheme:"palette",symbolSet:"file",table:"table",urbanModel:"urban-model",vectorTilePackage:"file-shape",vectorTileService:"map",visioDocument:"conditional-rules",webExperience:"apps",webMap:"map",webMappingApplication:"apps",webScene:"urban-model",wfs:"map",wFS:"map",wMS:"map",wMTS:"map",workflowManagerService:"file",workforceProject:"list-check"}[D(e)])&&void 0!==t?t:"file"},F=(t,a)=>{let r;return m(t,a)&&(r=`${e(a).replace("/api/v3","")}/datasets/${t.id}_0/FeatureServer/0`),r},E=e=>{const t=e&&e.match(/\/\d+$/);return t&&t[0].slice(1)},q=e=>e&&"feature service"===e.toLowerCase();function H(e,t=[]){return"Site Application"===e||"Hub Site Application"===e||"Web Mapping Application"===e&&t.includes("hubSite")}function O(e={}){let t=e.type;const a=e.typeKeywords||[];return H(e.type,a)&&(t="Hub Site Application"),("Site Page"===e.type||"Web Mapping Application"===e.type&&o(a,"hubPage"))&&(t="Hub Page"),"Hub Initiative"===e.type&&o(a,"hubInitiativeTemplate")&&(t="Hub Initiative Template"),"Web Mapping Application"===e.type&&o(a,"hubSolutionTemplate")&&(t="Solution"),t}const V=(e,t,a)=>{const r=E(e.url),i=r?parseInt(r,10):a;return t&&(h(i)?q(e.type)&&(e=>{const t=e&&1===e.length?e[0]:void 0;return t&&t.capabilities.includes("Query")?t:void 0})(t):t.find((e=>e.id===i)))},G=(e,t)=>{const{slug:s,requestOptions:b,data:v,metadata:S,groupIds:D,ownerUser:h,org:w,errors:M,server:A,layers:I,recordCount:H,boundary:G,extent:R,searchDescription:K,statistics:_}=t||{},N=V(e,I,null==t?void 0:t.layerId),z=((e,t,a)=>m(e,a)?e.id:k(e,a)?t?`${e.id}_${t.id}`:(e=>{if("public"!==e.access)return;const t=e.id,a=(e=>E(e.url)||q(e.type)&&e.typeKeywords&&o(e.typeKeywords,"Singlelayer")&&"0")(e);return a?`${t}_${a}`:t})(e):void 0)(e,N,b),J=s||z||e.id,Q=((e,t,a,r)=>((C(e,t,a,r)?t.name:e.title||e.name)||"").replace(/_/g," "))(e,N,I,b),B=C(e,N,I,b)&&N.description,X=N?N.type:O(e),Y=Object.assign({relative:f(X,J,e.typeKeywords)},b&&((e,t)=>{const a=t.authentication,r=a&&a.token;return{portalHome:y(e.id,t),portalApi:i(e,t,r),portalData:((e,t,a)=>{const r=i(e,t,a),o=new RegExp(`\\/${e.id}\\?f=json`);return r&&r.replace(o,`/${e.id}/data`).replace(/\&token/,"?token")})(e,t,r),thumbnail:n(e,t,{token:r})}})(e,b)),Z=F(e,b),ee=((e,t)=>x(t.metadata,"reviseDate")||W(t,"layer")||W(t,"server")||$(e,"modified"))(e,{metadata:S,layer:N,server:A}),te=((e,t)=>x(t,"pubDate")||x(t,"createDate")||$(e,"created"))(e,S),ae=((e,t)=>x(t,"metadataUpdatedDate")||$(e,"modified"))(e,S),re="update"===e.itemControl||"admin"===e.itemControl,ie="admin"===e.itemControl;return Object.assign(Object.assign({item:e},e),{slug:s,data:v,metadata:S,groupIds:D,ownerUser:h,org:w,errors:M||[],server:A,layers:I,recordCount:H,statistics:_,hubId:z,identifier:J,get isProxied(){return!!Z},layer:N,name:Q,get canEdit(){return re},get canDelete(){return ie},get title(){return Q},get description(){return B||e.description},type:X,get family(){return a(X)},get url(){return Z||(N?`${P(e.url)}/${N.id}`:e.url)},get categories(){return function(e){if(!e)return e;const t=["categories",""];return e.map((e=>e.split("/"))).reduce(((e,t)=>[...e,...t]),[]).filter((e=>!o(t,e.toLowerCase())))}(e.categories)},get actionLinks(){return e.properties&&e.properties.links},get hubActions(){return e.properties&&e.properties.actions},get isDownloadable(){return function(e){return-1!==j.indexOf(e.type)||e.typeKeywords&&T.some((t=>e.typeKeywords.some((e=>e===t))))}(e)},get structuredLicense(){return r(e.licenseInfo)},get permissions(){return{visibility:e.access,control:e.itemControl||"view"}},get extent(){return l(e,R,N)},get boundary(){return"automatic"===(null==G?void 0:G.provenance)?G:c(e)},get summary(){return K||e.snippet||e.description},urls:Y,get portalHomeUrl(){return Y.portalHome},get portalDataUrl(){return Y.portalData},get portalApiUrl(){return Y.portalApi},get thumbnailUrl(){return Y.thumbnail},get createdDate(){return new Date(e.created)},createdDateSource:"item.created",get updatedDate(){return ee.date},get updatedDateSource(){return ee.source},get updatedDatePrecision(){return ee.precision},get modified(){return ee.date.getTime()},get publishedDate(){return te.date},get publishedDateSource(){return te.source},get publishedDatePrecision(){return te.precision},get metadataUpdatedDate(){return ae.date},get metadataUpdatedDateSource(){return ae.source},get metadataUpdatedDatePrecision(){return ae.precision},get updateFrequency(){return L(S)},get metadataUpdateFrequency(){return L(S,"metadataUpdateFrequency")},get publisher(){return p(e,S,w,h)},get metrics(){return e.properties&&e.properties.metrics},get spatialReference(){var t;return(null===(t=null==N?void 0:N.extent)||void 0===t?void 0:t.spatialReference)||u(e)},get viewDefinition(){const e=N&&(e=>e.isView)(N)&&v&&Array.isArray(v.layers)&&v.layers.find((e=>e.id===N.id));return e?e.layerDefinition:void 0},get orgId(){return w?w.id:d(e,h)},get contentTypeIcon(){return U(X)},get additionalResources(){return g(e,S)},get itemControl(){return e.itemControl||"view"}})};export{F as a,E as b,G as c,U as d,V as g,H as i,O as n}