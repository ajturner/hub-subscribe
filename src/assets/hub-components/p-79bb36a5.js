import{c as e,a as r}from"./p-7853d817.js";import{_ as o}from"./p-d763eacf.js";import{g as n}from"./p-377e1b5e.js";import{r as t}from"./p-dcdf7b57.js";import{f as i}from"./p-24ecdf64.js";import{c as l}from"./p-f845584b.js";function s(e){var r=e.every((function(e){return e.success})),o=e.reduce((function(e,r){return e.concat(r.errors||[])}),[]),n={success:r};return o.length>0&&(n.errors=o),n}function u(e,o,n){let t=Promise.resolve(null);if(o.length){const i={id:e,users:o.map((e=>e.username)),authentication:n};t=r(i)}return t}function a(r,i,l,u=20160,a="group_member"){let d=Promise.resolve(null);return i.length&&(d=function(r){var i=r.id,l=n(r)+"/community/groups/"+i+"/invite",u=function(r){return e(r.users,25).map((function(e){return function(e,r){var n=Object.assign({},r);return n.params=o(o({},n.params),{users:e,role:n.role,expiration:n.expiration}),n}(e,r)}))}(r).map((function(e){return function(e,r){return t(e,r).catch((function(e){return{errors:[e]}}))}(l,e)}));return Promise.all(u).then(s)}({id:r,users:i.map((e=>e.username)),authentication:l,role:a,expiration:u})),d}async function d(e,r,o,n){const t=[],l=[],s=[],d=[],c=[];for(const m of r){let r=!0;const p={username:m,add:null,invite:null},f={username:m},v=i(u),g=i(a);if(n){const n=await v(e,[f],o.authentication);p.add=n,n.notAdded&&0!==n.notAdded.length?s.push(m):(r=!1,t.push(m))}if(r){const r=await g(e,[f],o.authentication);p.invite=r,r.success?l.push(m):d.push(m)}c.push(p)}return{added:t,invited:l,notAdded:s,notInvited:d,responses:c}}const c={schemaVersion:1,scopes:{user:{targetEntity:"communityUser",filters:[{predicates:[{q:"*"}]}]}},collections:[{key:"user",label:"Users",scope:{targetEntity:"communityUser",filters:[{predicates:[{q:"*"}]}]},targetEntity:"communityUser"}]};function m(e,r,o){var n,t;const i=r.trustedOrgIds&&(null==r?void 0:r.trustedOrgIds.filter((e=>{var o;return e!==(null===(o=null==r?void 0:r.currentUser)||void 0===o?void 0:o.orgId)&&e!==(null==r?void 0:r.communityOrgId)}))),s={label:"From",key:"from",display:"single-select",operation:"AND",options:[{label:o.t("addMembers.modal.org"),key:"org",selected:!0,predicates:[{orgid:null===(n=null==r?void 0:r.currentUser)||void 0===n?void 0:n.orgId},{group:{not:null==e?void 0:e.id}}]}]};return(null==e?void 0:e.membershipAccess)&&"organization"!==(null==e?void 0:e.membershipAccess)&&(null==r?void 0:r.communityOrgId)&&s.options.push({label:o.t("addMembers.modal.community"),key:"community",selected:!1,predicates:[{orgid:null==r?void 0:r.communityOrgId,searchUserAccess:"includeTrustedOrgs"},{group:{not:null==e?void 0:e.id}}]}),(null==e?void 0:e.membershipAccess)&&"organization"!==(null==e?void 0:e.membershipAccess)&&(null==i?void 0:i.length)>0&&l("platform:portal:admin:assignToGroups",r).access&&(l("platform:portal:user:invitePartneredCollaborationMembers",r).access||l("platform:portal:user:addExternalMembersToGroup",r).access)&&s.options.push({label:o.t("addMembers.modal.partner"),key:"partners",selected:!1,predicates:[{orgid:i,searchUserAccess:"includeTrustedOrgs"},{group:{not:null==e?void 0:e.id}}]}),(null==e?void 0:e.membershipAccess)&&"anyone"===(null==e?void 0:e.membershipAccess)&&!(null==e?void 0:e.isSharedUpdate)&&s.options.push({label:o.t("addMembers.modal.world"),key:"world",selected:!1,predicates:[{orgid:{type:"range",from:"0",to:"\\{"}},{orgid:{not:[null===(t=null==r?void 0:r.currentUser)||void 0===t?void 0:t.orgId,null==r?void 0:r.communityOrgId]}},{group:{not:null==e?void 0:e.id}}]}),[s]}export{d as a,m as g,c as p}