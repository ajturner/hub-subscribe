import{e as t,i as e,c as a,g as n,b as r}from"./p-d1b12a9c.js";import{g as o}from"./p-a0deb8c6.js";import{g as i}from"./p-796574a4.js";import{p as s}from"./p-6dcae6cd.js";import{g as d}from"./p-3f64a9d9.js";import{g as c}from"./p-2acb70a6.js";function p(t,e){return`${d(e)}/home/item.html?id=${t}`}var u;!function(t){t.CitationContact="metadata.resource.citation.contact",t.ResourceContact="metadata.resource.contact",t.MetadataContact="metadata.contact",t.ItemOwner="item.owner",t.None="none"}(u||(u={}));const m={devext:"dev",qaext:"qa",production:""},l=a=>{var o;const i=a.extent,s=e(i),d=(null===(o=a.properties)||void 0===o?void 0:o.boundary)||(s?"item":void 0),c={geometry:null,provenance:d};if("item"===d&&s){const e=r(i),a=n(e);c.center=[a.x,a.y],c.geometry=Object.assign(Object.assign({},t(e)),{type:"polygon"}),c.spatialReference=c.geometry.spatialReference}return c},b=t=>t&&t.isPortal,f=(t,e)=>!!t&&"public"===t.access&&!b(e),g=(t,e)=>!b(e)&&"public"===t.access&&"CSV"===t.type&&t.size<=5e6,$=(t,e,a)=>{let n=h(t,e,a)||I(t,e,a);if(!n){const r=o(t),i=["app","dataset","document","map","template","project","discussion"];let s="/content";"feedback"===r?s="/feedback/surveys":v(t,a)?s="/pages":i.indexOf(r)>-1&&(s=`/${r}s`),n=`${s}/${e}`}return n},v=(t,e=[])=>["Hub Page","Site Page"].includes(t)||e.includes("hubPage"),h=(t,e,a)=>{let n;return"Solution"===t?n=(null==a?void 0:a.indexOf("Deployed"))>-1?`/content/${e}/about`:`/templates/${e}/about`:"Web Mapping Application"===t&&(null==a?void 0:a.indexOf("hubSolutionTemplate"))>-1&&(n=`/templates/${e}/about`),n},I=(t,e,a)=>{if("Hub Initiative"===t&&(null==a?void 0:a.indexOf("hubInitiativeTemplate"))>-1||"Hub Initiative Template"===t)return`/initiatives/templates/${e}/about`};function y(t){return{updateFrequency:"metadata.dataIdInfo.resMaint.maintFreq.MaintFreqCd.@_value",reviseDate:"metadata.dataIdInfo.idCitation.date.reviseDate",pubDate:"metadata.dataIdInfo.idCitation.date.pubDate",createDate:"metadata.dataIdInfo.idCitation.date.createDate",metadataUpdateFrequency:"metadata.mdMaint.maintFreq.MaintFreqCd.@_value",metadataUpdatedDate:"metadata.mdDateSt"}[t]}function k(t,e){const a=y(e);return a&&i(t,a)}var D;function S(t){let e,a;if(/^\d{4}$/.test(t=`${t}`))e=new Date(+t,0,1),a=D.Year;else if(/^\d{4}-\d{1,2}$/.test(t)){const n=t.split("-");e=new Date(+n[0],+n[1]-1,1),a=D.Month}else if(/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)){const n=t.split("-");e=new Date(+n[0],+n[1]-1,+n[2]),a=D.Day}else Number.isNaN(Date.parse(t))||(e=new Date(t),a=t.includes("T")?D.Time:D.Day);return e&&a&&{date:e,precision:a}}!function(t){t.Year="year",t.Month="month",t.Day="day",t.Time="time"}(D||(D={}));const x=t=>{const e=t.spatialReference;if(!e||"object"==typeof e)return e;const a=parseInt(e+"",10);return isNaN(a)?null:{wkid:a}},M=(t,e,a)=>{const n=j(e);return n&&n.map((e=>({name:e.orName,url:C(e,t,a),isDataSource:q(e,t)})))},j=t=>{const e=[];return w(i(t,"metadata.distInfo")||[]).forEach((t=>{w(t.distTranOps||[]).forEach((t=>{w(t.onLineSrc||[]).forEach((t=>{e.push(t)}))}))})),e.length?e:null},w=t=>Array.isArray(t)?t:[t],q=(t,e)=>{const a=e.url&&s(e.url);return a&&t.linkage&&t.linkage.includes(a)},C=(t,e,a)=>{let n=t.linkage;const r=i(a,"authentication.token");if(r&&q(t,e)){const e=new URL(t.linkage),a=new URLSearchParams(e.search);a.set("token",r),e.search=a.toString(),n=e.toString()}return n},W=(t,n,r)=>{const o=e(t.extent)?t.extent:void 0,s=e(null==n?void 0:n.coordinates)?n.coordinates:void 0,d=4326===i(r,"extent.spatialReference.wkid")?a(r.extent):void 0;return o||s||d},A=(t,e)=>{const a=i(t,e)||{},{rpIndName:n,rpOrgName:r}=Array.isArray(a)?a[0]:a;return{individualName:n,organizationName:r}},N=(t,e)=>t.orgId||(null==e?void 0:e.orgId),P=(t,e,a,n)=>{const r={nameSource:u.None,organizationSource:u.None},o=A(e,"metadata.dataIdInfo.idCitation.citRespParty"),s=A(e,"metadata.dataIdInfo.idPoC"),d=A(e,"metadata.mdContact"),c=i(n,"fullName");o.individualName?(r.name=o.individualName,r.nameSource=u.CitationContact):s.individualName?(r.name=s.individualName,r.nameSource=u.ResourceContact):d.individualName?(r.name=d.individualName,r.nameSource=u.MetadataContact):c&&(r.name=c,r.username=n.username,r.nameSource=u.ItemOwner);const p=i(a,"name");return o.organizationName?(r.organization=o.organizationName,r.organizationSource=u.CitationContact):s.organizationName?(r.organization=s.organizationName,r.organizationSource=u.ResourceContact):d.organizationName?(r.organization=d.organizationName,r.organizationSource=u.MetadataContact):p&&(r.organization=p,r.orgId=N(t,n),r.organizationSource=u.ItemOwner),r.isExternal=r.organizationSource===u.None&&"public"!==t.access,r},F=t=>t.reduce(((t,e)=>{const a=e.split("/"),n=a[a.length-1];return n&&t.push(n),t}),[]),E=(t,e)=>{let a;switch(U(t)){case"Dashboard":a=T(t,e);break;case"Insights Workbook":a=z(t,e);break;case"Experience":a=R(t,e);break;case"Web AppBuilder":a=H(t,e);break;case"Form":a=O(t,e);break;case"StoryMap":a=B(t,e);break;case"Urban Model":a=L(t,e);break;default:a=p(t.id,e)}return a},U=t=>{const e=t.typeKeywords||[];let a=t.type;return"StoryMap"===t.type||"Web Mapping Application"===t.type&&e.includes("Story Map")?a="StoryMap":"Insights Page"===t.type?a="Insights Page":"Insights Workbook"===t.type?a="Insights Workbook":t.type&&t.type.includes("Insights")?a="Insights":"Web Experience"===t.type||"Web Mapping Experience"===t.type&&e.includes("EXB Experience")?a="Experience":e.includes("Web AppBuilder")&&(a="Web AppBuilder"),a},B=(t,e)=>{const a=d(e);return`https://${{devext:"storymapsdev",qaext:"storymapsqa",production:"storymaps"}[c(a)]}.arcgis.com/stories/${t.id}/edit`},R=(t,e)=>{const a=d(e),n=c(a);return`https://experience${m[n]}.arcgis.com/builder/?id=${t.id}`},T=(t,e)=>{const a=d(e);let n=`${a}/apps/opsdashboard/index.html#/${t.id}?mode=edit`;return t.typeKeywords&&t.typeKeywords.includes("ArcGIS Dashboards")&&(n=`${a}/apps/dashboards/${t.id}#mode=edit`),n},H=(t,e)=>`${d(e)}/apps/webappbuilder/index.html?id=${t.id}`,O=(t,e)=>{const a=d(e),n=c(a),r=`https://survey123${m[n]}.arcgis.com`;let o;return o=t.typeKeywords.includes("Survey123 Connect")?p(t.id,a):`${r}/surveys/${t.id}/design?portalUrl=${a}`,o},z=(t,e)=>{const a=d(e),n=c(a),r=`https://insights${m[n]}.arcgis.com`,o=p(t.id,a);return _(a)?o:`${r}/#/edit/${t.id}`},L=(t,e)=>{const a=d(e),n=c(a),r=`https://urban${m[n]}.arcgis.com`,o=p(t.id,a);return _(a)?o:`${r}/?id=${t.id}`},_=t=>-1===t.indexOf("arcgis.com");export{D,$ as a,E as b,f as c,N as d,W as e,l as f,p as g,k as h,P as i,x as j,M as k,g as l,y as m,v as n,F as o,S as p}