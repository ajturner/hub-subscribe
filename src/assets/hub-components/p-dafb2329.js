import{O as e,c as t,a,P as n,i as r,s,f as o}from"./p-6f931af6.js";import{g as i}from"./p-796574a4.js";import{g as c}from"./p-235bb6ee.js";import{s as m,g as u}from"./p-992b9d10.js";import{j as p,k as d,g as l,b as f,m as y,n as b,o as w,q as j,r as g,t as O}from"./p-85d6867e.js";import{u as h}from"./p-b728aff4.js";import{a as D}from"./p-783242bc.js";import{g as v}from"./p-7202c430.js";import{g as k}from"./p-3f64a9d9.js";import{_ as K}from"./p-d763eacf.js";import{g as q}from"./p-377e1b5e.js";import{r as S}from"./p-dcdf7b57.js";import{s as R}from"./p-52612356.js";import{u as G}from"./p-895b662f.js";import{m as M}from"./p-8dbea197.js";import{g as C}from"./p-a0deb8c6.js";import{i as $}from"./p-59fd2498.js";import{g as z}from"./p-cea8413b.js";function A(e){return c(e,"group")}function F(e,t){return`${k(t)}/home/group.html?id=${e}`}const I=(e,t,n)=>{const{data:r,stack:s,requestOptions:o}=t;return s.finish(n,{error:e}),{data:Object.assign(Object.assign({},r),{errors:a(e,r.errors)}),stack:s,requestOptions:o}},U={membershipSummary:e=>{const{data:t,stack:a,requestOptions:n}=e,r=a.start("enrichGroupMembershipSummary"),s=Object.assign({num:3},n);return m(t.group.id,s).then((e=>(a.finish(r),{data:Object.assign(Object.assign({},t),{membershipSummary:{total:e.total,users:e.users}}),stack:a,requestOptions:n}))).catch((t=>I(t,e,r)))},contentCount:e=>{const{data:t,stack:a,requestOptions:n}=e,r=a.start("enrichGroupContentCount");return(s=Object.assign({groupId:t.group.id,num:1},n),c(s,"groupContent")).then((e=>(a.finish(r),{data:Object.assign(Object.assign({},t),{contentCount:e.total}),stack:a,requestOptions:n}))).catch((t=>I(t,e,r)));var s},userMembership:e=>{const{data:t,stack:a,requestOptions:n}=e,r=a.start("enrichGroupUserMembership");return u(t.group.id,n).then((e=>(a.finish(r),{data:Object.assign(Object.assign({},t),{membershipAccess:e.membershipAccess,userMembership:i(e,"userMembership.memberType")}),stack:a,requestOptions:n}))).catch((t=>I(t,e,r)))}},x={name:"No title provided",access:"private",permissions:[],typeKeywords:[]};function E(){const e=[];return e.push({entityKey:"name",storeKey:"title"}),e.push({entityKey:"summary",storeKey:"snippet"}),e.push({entityKey:"permissions",storeKey:"properties.permissions"}),["access","autoJoin","description","id","isInvitationOnly","isDiscussable","isReadOnly","isViewOnly","membershipAccess","owner","protected","sortField","sortOrder","tags","thumbnail","thumbnailUrl","typeKeywords","userMembership"].forEach((t=>{e.push({entityKey:t,storeKey:t})})),e}function J(e){const t=new n(E()).entityToStore(e,{});return"organization"===t.membershipAccess&&(t.membershipAccess="org"),"collaborators"===t.membershipAccess&&(t.membershipAccess="collaboration"),"anyone"===t.membershipAccess&&(t.membershipAccess=null,t._clearEmptyFields=!0),t}function N(e,t){let a;return t.authentication&&(a=t.authentication.token),{self:F(e.id,t),siteRelative:`/groups/${e.id}`,workspaceRelative:v("Group",e.id),thumbnail:D(t.portal,e,a)}}function P(e,t){return function(e,t,a){var n,s,o;let i;return a.authentication&&(i=a.authentication.token),t.thumbnailUrl=D(a.portal,e,i),t.createdDate=new Date(e.created),t.createdDateSource="group.created",t.updatedDate=new Date(e.modified),t.updatedDateSource="group.modified",t.type="Group",t.isDiscussable=r(e),t.isSharedUpdate=(e.capabilities||[]).includes("updateitemcontrol"),t.memberType=null===(n=e.userMembership)||void 0===n?void 0:n.memberType,t.membershipAccess="anyone","org"===e.membershipAccess&&(t.membershipAccess="organization"),"collaboration"===e.membershipAccess&&(t.membershipAccess="collaborators"),t.canEdit="owner"===(null===(s=e.userMembership)||void 0===s?void 0:s.memberType)||"admin"===(null===(o=e.userMembership)||void 0===o?void 0:o.memberType),t.canDelete=t.canEdit,t.links=N(e,a),t}(e,new n(E()).storeToEntity(e,{}),t)}async function T(a,n,r){const s={access:a.access,id:a.id,type:"Group",name:a.title,owner:a.owner,summary:a.snippet||a.description,createdDate:new Date(a.created),createdDateSource:"group.created",updatedDate:new Date(a.modified),updatedDateSource:"group.modified",family:"team",links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};s.isSharedUpdate=(a.capabilities||[]).includes("updateitemcontrol"),s.membershipAccess=a.membershipAccess,s.isOpenData=!!a.isOpenData;const o=(n=[...n].filter(h)).map(p),c=M("enrichment",o).filter(h);let m={};return c.length&&(m=await function(a,n,r){const s=n.reduce(((e,t)=>{const a=U[t];return a&&e.push(a),e}),[]);return t(s)({data:{group:a},stack:new e,requestOptions:r}).then((e=>e.data))}(a,c,r)),o.forEach((e=>{s[e.prop]=i(m,e.path)})),s.links=N(a,r),s}async function V(e,t){const a=Object.assign(Object.assign({},x),e);a.typeKeywords=s(a.typeKeywords,a.isDiscussable);const n={group:J(a),authentication:t.authentication};return P((await function(e){var t=q(e)+"/community/createGroup";return e.params=K(K({},e.params),e.group),S(t,e)}(n)).group,t)}async function _(e,t){return P(await u(e,t),t)}async function B(e,t){e.typeKeywords=s(e.typeKeywords,e.isDiscussable);const a=J(e),n={group:a,authentication:t.authentication};return a._clearEmptyFields&&R("params.clearEmptyFields",!0,n),await G(n),e}async function H(e,t){const a=Object.assign(Object.assign({},t),{id:e});await function(e){var t=q(e)+"/community/groups/"+e.id+"/delete",a=K({},e);return S(t,a)}(a)}async function L(e,t){let a;return a=$(e)?z(e,t):l(e,t),a.then((e=>e?async function(e,t){const a=await f(e,t),r=new n(y()).storeToEntity(a,{});return d(a,r,t)}(e,t):null))}async function Q(e,t,a){const n={access:e.access,id:e.id,type:e.type,name:e.title,owner:e.owner,typeKeywords:e.typeKeywords,tags:e.tags,categories:e.categories,summary:e.snippet||e.description,createdDate:new Date(e.created),createdDateSource:"item.created",updatedDate:new Date(e.modified),updatedDateSource:"item.modified",family:C(e.type),links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented",workspaceRelative:"not-implemented"}},r=(t=[...t].filter(h)).map(p),s=M("enrichment",r).filter(h);let c={};return s.length&&(c=await o(e,s,a)),r.forEach((e=>{n[e.prop]=i(c,e.path)})),n.links=b(e,a),n}async function W(e,t){let a;return a=$(e)?z(e,t):l(e,t),a.then((e=>e?async function(e,t){const a=await f(e,t),r=new n(j()).storeToEntity(a,{});return w(a,r,t)}(e,t):null))}async function X(e,t,a){const n={access:e.access,id:e.id,type:e.type,name:e.title,owner:e.owner,typeKeywords:e.typeKeywords,tags:e.tags,categories:e.categories,summary:e.snippet||e.description,createdDate:new Date(e.created),createdDateSource:"item.created",updatedDate:new Date(e.modified),updatedDateSource:"item.modified",family:C(e.type),links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented",workspaceRelative:"not-implemented"}},r=(t=[...t].filter(h)).map(p),s=M("enrichment",r).filter(h);let c={};return s.length&&(c=await o(e,s,a)),r.forEach((e=>{n[e.prop]=i(c,e.path)})),n.links=g(e,a),n.deployedType=O(e),n}export{x as D,W as a,L as b,X as c,Q as d,T as e,_ as f,V as g,H as h,J as i,F as j,A as s,B as u}