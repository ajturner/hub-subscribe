import{r as t,c as i,d as e,h as r,F as o,H as s,a}from"./p-d4ba4c14.js";import{i as n}from"./p-be5c5009.js";import{I as l,C as c}from"./p-c29c8d33.js";import{S as h}from"./p-35a4fa90.js";import{b as d}from"./p-fd260f2d.js";import{g as p,c as m}from"./p-81a9bee2.js";import{a as u,f as b}from"./p-b728aff4.js";import{d as v}from"./p-97274a47.js";import{s as g}from"./p-992b9d10.js";import{b as f}from"./p-783242bc.js";import"./p-859c5360.js";import"./p-796574a4.js";import"./p-3904125b.js";import"./p-3f64a9d9.js";import"./p-377e1b5e.js";import"./p-637ea136.js";import"./p-a0deb8c6.js";import"./p-30a7cbb2.js";import"./p-90dc0f6f.js";import"./p-dd26efbb.js";import"./p-d1b12a9c.js";import"./p-dcdf7b57.js";import"./p-6dcae6cd.js";import"./p-2acb70a6.js";import"./p-d763eacf.js";import"./p-ad325ed1.js";import"./p-903ef8af.js";const w=class{constructor(e){t(this,e),this.arcgisHubCardSelect=i(this,"arcgisHubCardSelect",7),this.arcgisHubCardTitleLinkClick=i(this,"arcgisHubCardTitleLinkClick",7),this.arcgisHubCardAction=i(this,"arcgisHubCardAction",7),this.sanitizer=new h({whiteList:{},stripIgnoreTag:!0,stripIgnoreTagBody:["script"]}),this.model=void 0,this.layout="row",this.loading=void 0,this.showThumbnail=void 0,this.imageType=l.thumbnail,this.lazy=!1,this.newTab=void 0,this.selectable=void 0,this.selected=!1,this.itemTitle=void 0,this.source=void 0,this.summary=void 0,this.thumbnailUrl=void 0,this.family=void 0,this.additionalInfo=void 0,this.actionLinks=void 0,this.cardActionLinks=[],this.badges=void 0,this.type=void 0,this.identifier=void 0,this.corners=c.square,this.titleTag="div",this.showAdditionalInfo=!0,this.showAllAdditionalInfo=!1,this.shadow=void 0,this.showBadges=!0,this.showType=!0,this.showOwner=!0,this.clickable=!1,d(this,"onTitleLinkClick"),this.internalId=u("ahc")}get contentTypeIcon(){return"Feature Service"===this.model.type?"data":this.model.type?v(this.model.type):"file"}get primaryInfos(){if(this.showAdditionalInfo){let t=0;const i=this.model.additionalInfo||[];return"row"===this.layout&&(t=this.hasPrimaryAction?2:4,this.showAllAdditionalInfo&&(t=i.length)),i.slice(0,t)}return[]}get secondaryInfos(){let t=[];if(this.showAdditionalInfo){const i=this.primaryInfos.length;t=(this.model.additionalInfo||[]).slice(i,4-this.secondaryActions.length+i)}return t}get hasPopoverContent(){return!(!this.secondaryActions.length&&!this.secondaryInfos.length)}get hasPrimaryAction(){return!!this.primaryActions.length}get primaryActions(){return(this.model.actionLinks||[]).slice(0,1).filter((t=>t.action||t.href))}get secondaryActions(){return(this.model.actionLinks||[]).slice(1,3).filter((t=>t.action||t.href))}get isClickable(){var t;return this.clickable&&!!(null===(t=this.model)||void 0===t?void 0:t.titleUrl)}async componentWillLoad(){this.intl=await n.loadIntlForComponent(this.element)}async componentWillRender(){if(!this.model){let t={additionalInfo:[],actionLinks:[]};["summary","source","thumbnailUrl","family","type"].forEach((i=>{t=b(i,this[i],t)})),t=b("id",this.identifier,t),t=b("title",this.itemTitle,t),this.additionalInfo&&(t.additionalInfo=this.additionalInfo.split("|").map((t=>({i18nKey:t.split(":")[0],value:t.split(":")[1]})))),this.actionLinks&&(console.info("Action links are deprecated - use cardActionLinks instead"),t.actionLinks=this.actionLinks.split("|").map((t=>{const i=t.split(":");let e={action:i[0]};return e=b("icon",i[1],e),e=b("label",i[2],e),e}))),this.cardActionLinks&&(t.actionLinks=this.cardActionLinks),this.badges&&(t.badges=this.badges.split("|").map((t=>{const i=t.split(":");let e={color:i[0]};return e=b("icon",i[1],e),e=b("label",i[2],e),e}))),this.model=t}}handelCardSelectEvent(){this.arcgisHubCardSelect.emit(this.model)}get _thumbnailUrl(){var t,i;const{model:e}=this;let r;if(e.thumbnailUrl){r=e.thumbnailUrl;const o=null===(i=null===(t=p())||void 0===t?void 0:t.session)||void 0===i?void 0:i.token;if(o&&"public"!==e.access){const t=new URL(r);t.searchParams.append("token",o),r=t.toString()}const s=new URL(r);s.searchParams.append("w","400"),r=s.toString()}return r}get _fallbackUrl(){const{model:t}=this;return e("Group"===t.type?"./assets/groups-fallback.png":"./assets/content-fallback.png")}renderThumbnail(t){let i;if(this.showThumbnail&&!this.loading)if("User"===t.type||"channel"===t.type)i=this.renderAvatar(t);else{const e=this.getThumbnailClassName(t);i=this.imageType===l.thumbnail?r("arcgis-hub-image",{alt:this.intl.t("thumbnail"),class:e,fallback:this._fallbackUrl,lazy:this.lazy,src:this._thumbnailUrl}):r("div",{class:"icon-container"},r("calcite-icon",{icon:this.contentTypeIcon,scale:"l"}))}return this.isClickable?r("a",{href:t.titleUrl,slot:"thumbnail",target:this.newTab?"_blank":"_self"},i):r("div",{slot:"thumbnail"},i)}getThumbnailClassName(t){let i="content-thumbnail";return"Group"===t.type&&(i="group-thumbnail"),"Image"===t.type&&(i="image-thumbnail"),i}configureFullNameAvatar(t){var i;let e=t.title;return!t.thumbnailUrl&&t.title&&-1===(null===(i=null==t?void 0:t.title)||void 0===i?void 0:i.indexOf(" "))&&(e=(0===t.title.indexOf("@")?t.title.substring(1,3):t.title.substring(0,2)).split("").join(" ")),e}renderAvatar(t){return r("div",{class:"avatar-container"},r("calcite-avatar",{class:{"full-size-avatar":"row"===this.layout,"initials-avatar":"row"===this.layout&&!t.thumbnailUrl},"full-name":this.configureFullNameAvatar(t),scale:"l",thumbnail:t.thumbnailUrl,username:t.source}))}renderCardTitle(t){const{titleUrl:i,title:e}=t;if(e){return r(this.titleTag,{class:"title",slot:"title"},i?r("a",{href:i,onClick:this.onTitleLinkClick,target:this.newTab?"_blank":"_self"},t.title):r("span",null,e))}}onTitleLinkClick(t){this.arcgisHubCardTitleLinkClick.emit({model:this.model,event:t})}renderFooter(){const t=[];this.primaryInfos.length&&t.push(r("dl",{slot:"footer-start"},this.renderAdditionalInfo(this.primaryInfos)));const i=this.element.querySelector('[slot="actions"]');return(this.primaryActions.length||i)&&t.push(r("div",{slot:"footer-end"},r("slot",{name:"actions"}),this.renderActions(this.primaryActions,"solid"))),t}renderAdditionalInfo(t){return t.map((t=>r("div",{"data-test":t.i18nKey,key:t.i18nKey},r("dt",null,this.intl.t(t.i18nKey)),r("dd",null,t.value))))}renderPopoverAdditionalInfo(){if(this.secondaryInfos.length)return r("dl",null,this.renderAdditionalInfo(this.secondaryInfos))}actionHandler(t,i){console.log("arcgisHubCardAction",[t,i]),this.arcgisHubCardAction.emit({action:t,model:i})}renderActions(t,i="outline"){return t.map(((t,e)=>{let o=t.label;!o&&t.i18nKey&&(o=this.intl.t(t.i18nKey));const s=t.action&&this.actionHandler.bind(this,t.action,this.model);return r("calcite-button",{appearance:t.buttonStyle||i,color:"blue",href:t.href,iconStart:t.icon,key:e,label:o,onClick:s||void 0,width:"full"},t.showLabel&&o)}))}renderHeader(t){const i=this.showType&&!["Group","User"].includes(this.model.type);if(i||this.showBadges||this.hasPopoverContent){let e=this.intl.t(t.family||"other");return"Feature Service"===t.type&&(e=this.intl.t("dataset")),r("div",{slot:"title"},i&&r("div",{class:"content-type"},r(o,null,r("calcite-icon",{icon:this.contentTypeIcon}),r("span",null,e))),this.showBadges&&this.renderChips(t),this.hasPopoverContent&&this.renderPopover())}}renderChips(t){const i=(t.badges||[]).map(((t,i)=>{var e,o;const s=(t.i18nKey?this.intl.t(t.i18nKey):t.label)||null,a=(null===(e=t.tooltip)||void 0===e?void 0:e.i18nKey)?this.intl.t(t.tooltip.i18nKey):null===(o=t.tooltip)||void 0===o?void 0:o.label;return r("arcgis-ref-tooltip",{key:i,overlayPositioning:"fixed",placement:"top",text:a},r("calcite-chip",{class:t.color?`chip-color-${t.color}`:null,icon:t.icon,label:s,scale:"s",value:s},!t.hideLabel&&s))}));return r("div",{class:"chips"},i)}renderPopover(){return r("div",{class:"popover-container"},r("calcite-popover",{"auto-close":!0,label:this.intl.t("additionalInfo"),overlayPositioning:"fixed",placement:"bottom-end",referenceElement:"popover-toggle"},r("div",{class:"popover-content"},this.renderPopoverAdditionalInfo(),this.renderActions(this.secondaryActions))),r("calcite-button",{appearance:"transparent","icon-start":"ellipsis",id:"popover-toggle",kind:"neutral",round:!0,scale:"m"}))}renderSourceSlot(t){if(this.showOwner)return"Group"!==t.type?r("div",{class:"owner",slot:"subtitle"},t.source):r("arcgis-hub-group-member-summary",{identifier:t.id,slot:"subtitle"})}renderLayout(t,i=!1){let e="card"===this.layout?"block-start":"inline-start";return this.showThumbnail||(e="block-start"),r(s,null,r("calcite-card",{dir:this.intl.direction,loading:i,selectable:this.selectable,selected:this.selected,thumbnailPosition:e},this.renderThumbnail(t),this.renderHeader(t),this.renderCardTitle(t),this.renderSourceSlot(t),r("div",{class:"snippet"},this.sanitizer.sanitize(t.summary)),this.renderFooter()))}render(){return this.model?this.renderLayout(this.model,this.loading):"No data."}static get assetsDirs(){return["assets","locales"]}get element(){return a(this)}};w.style=":host{display:block;height:100%}:host([corners=\"round\"]){--calcite-border-radius-base:10px;border-radius:var(--calcite-border-radius-base)}:host([corners=\"round\"]) calcite-card{border-radius:var(--calcite-border-radius-base)}:host([shadow=\"low\"]) calcite-card{--tw-shadow:0 4px 8px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.04);--tw-shadow-colored:0 4px 8px -1px var(--tw-shadow-color), 0 2px 4px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}:host([shadow=\"medium\"]) calcite-card{--tw-shadow:0 6px 20px -4px rgba(0, 0, 0, 0.1), 0 4px 12px -2px rgba(0, 0, 0, 0.08);--tw-shadow-colored:0 6px 20px -4px var(--tw-shadow-color), 0 4px 12px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}:host([shadow=\"heavy\"]) calcite-card{--tw-shadow:0 12px 32px -2px rgba(0, 0, 0, 0.1), 0 4px 20px 0 rgba(0, 0, 0, 0.08);--tw-shadow-colored:0 12px 32px -2px var(--tw-shadow-color), 0 4px 20px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}h1,h2,h3,h4,h5,h6{font-family:var(--hub-heading-family, inherit)}calcite-card{height:100%}[slot=\"title\"]{display:flex;justify-content:space-between;gap:0.5rem}.content-type{margin-bottom:0.5rem;display:flex;align-items:center;gap:0.25rem;font-weight:var(--calcite-font-weight-bold)}.title>*{width:100%;font-size:var(--calcite-font-size-2);line-height:1.5rem;font-weight:var(--calcite-font-weight-medium);overflow-wrap:anywhere}.title a{color:var(--calcite-ui-text-link);-webkit-text-decoration-line:var(--hub-text-decoration, underline);text-decoration-line:var(--hub-text-decoration, underline)}:host([clickable]) .title a::after{position:absolute;top:0;right:0;bottom:0;left:0;z-index:1;pointer-events:auto;content:\"\";background-color:rgba(0,0,0,0)}.owner{margin-top:0.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;font-weight:var(--calcite-font-weight-medium)}.snippet{margin-left:0px;margin-right:0px;font-size:var(--calcite-font-size-0);line-height:1.25rem;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;height:2.5rem;padding-bottom:0.14rem;overflow-wrap:anywhere;color:var(--hub-gallery-body-text)}dl[slot='footer-start']{margin:0px;display:grid;width:100%;gap:0.25rem;font-size:var(--calcite-font-size--1);line-height:normal;grid-template-columns:repeat(auto-fill, minmax(max(200px, (100% - (2 - 1) * 0.25rem) / 2), 1fr))}calcite-popover dl>div,dl[slot='footer-start']>div{display:flex;gap:0.25rem;overflow:hidden;white-space:nowrap}calcite-popover dt::after,dl[slot='footer-start'] dt::after{content:':'}calcite-popover dd,dl[slot='footer-start'] dd{margin:0px;overflow:hidden;text-overflow:ellipsis;font-weight:var(--calcite-font-weight-bold)}.chips{margin-left:auto;display:flex;gap:0.25rem}.popover-container{position:relative}.chips calcite-chip.chip-color-blue{color:var(--calcite-ui-foreground-1);background-color:var(--calcite-ui-brand)}.chips calcite-chip.chip-color-red{color:var(--calcite-ui-foreground-1);background-color:var(--calcite-ui-danger)}.chips calcite-chip.chip-color-yellow{color:var(--calcite-ui-foreground-1);background-color:var(--calcite-ui-warning)}.chips calcite-chip.chip-color-green{color:var(--calcite-ui-foreground-1);background-color:var(--calcite-ui-success)}.chips calcite-chip.chip-color-gray{color:var(--calcite-ui-text-1);background-color:var(--calcite-ui-border-3)}calcite-popover .popover-content{display:flex;flex-direction:column;align-items:stretch;gap:0.25rem;padding:0.5rem;width:max-content;max-width:14.5rem;}calcite-popover .popover-content:lang(el){font-size:var(--calcite-font-size--3)}calcite-popover dl{margin:0.5rem;display:flex;flex-direction:column;gap:0.25rem}#popover-toggle{vertical-align:middle}*[slot=\"thumbnail\"]{display:block;height:100%;width:100%}.avatar-container,.icon-container{display:grid;height:100%;width:100%;align-content:center;justify-content:center;color:var(--calcite-ui-brand)}.avatar-container calcite-avatar{height:6rem;width:6rem}.icon-container calcite-icon{height:4rem;width:4rem}:host([selectable]) [slot=\"title\"]{margin-right:1.5rem}:host([layout='card']) calcite-card{height:100%;width:100%}:host([layout='card']) .avatar-container,:host([layout='card']) .icon-container{padding-top:0.5rem;padding-bottom:0.5rem}:host([layout='card']) .title{height:3rem}:host([layout='card']) .title>*{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}:host([layout='card']) .owner{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;height:2.5rem}:host([layout=\"card\"]) [slot=\"footer-end\"]{width:100%}:host([layout='row']) .title>*{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}@media only screen and (min-width: 769px){:host([layout='row']) .title>*{display:inline}:host([layout='row']) .title>*{overflow:visible}:host([layout='row']) .title>*{-webkit-line-clamp:unset}}:host([layout='row']) .owner{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}:host([layout=\"row\"]) .snippet{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}:host([layout=\"row\"]) [slot=\"footer-end\"]{margin-left:auto}";const x=class{constructor(i){t(this,i),this._context=p(),this.identifier=void 0,this.membershipSummary=void 0,this.hasMembersError=!1}connectedCallback(){m(this)}disconnectedCallback(){this.disconnectContext()}async componentWillLoad(){this.intl=await n.loadIntlForComponent(this.element),this.membershipSummary||this.fetchMembers()}async fetchMembers(){try{const t=this._context;if(this.hasMembersError=!1,t&&(null==this?void 0:this.identifier)){const i={num:3,sortField:"memberType"};(null==t?void 0:t.session)?i.authentication=t.session:i.portal=t.sharingApiUrl;const e=await g(this.identifier,i);this.membershipSummary={total:e.total,users:e.users}}}catch(t){this.hasMembersError=!0,console.error("Error fetching group members:",t.message)}}getMemberCount(t){return 0===t?this.intl.t("noMember"):1===t?this.intl.t("oneMember"):this.intl.t("members",{count:t})}renderMembers(t){const i=this._context;if(!this.hasMembersError){let e="&nbsp;";return t&&(e=r(o,null,r("div",{class:"members-inner"},t.users.map((t=>{var e;const o=i?f(i.sharingApiUrl,t,null===(e=i.session)||void 0===e?void 0:e.token):void 0;return r("calcite-avatar",{fullName:t.fullName,key:t.username,scale:"s",thumbnail:o,username:t.username})}))),r("span",{class:"members-count"},this.getMemberCount(t.total)))),r("div",{class:{"members-container":!0,loading:!t},slot:"subtitle"},e)}}render(){return r(s,null,this.renderMembers(this.membershipSummary))}static get assetsDirs(){return["locales"]}get element(){return a(this)}static get watchers(){return{identifier:["fetchMembers"],_context:["fetchMembers"]}}};x.style=":host{display:block}.members-container.loading{position:relative}.members-container.loading:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0}@keyframes shimmer{0%{background-size:200% 100%;background-position:100% 0}100%{background-size:200% 100%;background-position:-100% 0}}.members-container.loading:after{animation:shimmer 2s cubic-bezier(0.4, 0, 0.2, 0.8) infinite;background-image:linear-gradient(90deg, rgba(255, 255, 255, 0) 0, rgba(255, 255, 255, 0) 40%, rgba(255, 255, 255, 0.6) 50%, rgba(255, 255, 255, 0) 60%, rgba(255, 255, 255, 0) 100%);background-color:var(--calcite-ui-foreground-3)}.members-container.loading{height:1.5rem}.members-container{display:flex;align-items:center;gap:0.25rem;font-weight:var(--calcite-font-weight-medium)}.members-inner{display:flex}.members-inner calcite-avatar{border-width:1px;border-style:solid;border-color:var(--calcite-ui-border-1)}.members-inner calcite-avatar:nth-child(n+2){margin-left:-10px}.members-count{font-size:var(--calcite-font-size-0);line-height:1.25rem}";const y={rootMargin:"10%"};class k{constructor(){this.intersectionObserver=new IntersectionObserver(this.onEnteredViewport.bind(this),y),this.handlers=new WeakMap}static create(){return k.instance||(k.instance=new k),k.instance}static addHandler(t,i){this.create(),this.instance.addHandler(t,i)}static removeHandler(t,i){this.instance&&this.instance.removeHandler(t,i)}static unobserve(t){this.instance&&this.instance.unobserve(t)}addHandler(t,i){this.handlers.has(t)||(this.handlers.set(t,[]),this.intersectionObserver.observe(t));const e=this.handlers.get(t);e.includes(i)||e.push(i)}removeHandler(t,i){if(this.handlers.has(t)){const e=this.handlers.get(t),r=e.indexOf(i),o=e.filter(((t,i)=>i!==r));o.length?this.handlers.set(t,o):(this.handlers.delete(t),this.intersectionObserver.unobserve(t))}}unobserve(t){this.handlers.has(t)&&(this.handlers.delete(t),this.intersectionObserver.unobserve(t))}onEnteredViewport(t){requestAnimationFrame((()=>{t.forEach((t=>{var i;t.isIntersecting&&(null!==(i=this.handlers.get(t.target))&&void 0!==i?i:[]).forEach((t=>t()))}))}))}}const j=class{constructor(i){t(this,i),this.src=void 0,this.alt=void 0,this.fallback=void 0,this.lazy=!1,this.corners=c.square,this.hasError=!1,this.inViewport=!1,d(this,"setImageEl","handleIntersection")}get _imageUrl(){let t=this.src;return this.src||(t=this.fallback),this.hasError&&(t=this.fallback),this.lazy&&!this.inViewport&&(t=void 0),t}componentWillLoad(){this.lazy&&this.observe()}disconnectedCallback(){this.lazy&&this.unobserve()}observe(){k.addHandler(this.element,this.handleIntersection)}unobserve(){k.unobserve(this.element)}srcUpdated(){this.hasError=!1}handleIntersection(){this.inViewport=!0,this.unobserve()}setImageEl(t){this.imageEl=t}componentDidRender(){if(this.imageEl){const t=()=>{this.hasError=!0,this.imageEl.removeEventListener("error",t)};this.imageEl.addEventListener("error",t)}}renderImage(){return this._imageUrl&&r("img",{alt:this.alt,class:{"rounded-corners":this.corners===c.round},ref:this.setImageEl,src:this._imageUrl})}render(){return r(s,{"data-element":"image"},this.renderImage())}get element(){return a(this)}static get watchers(){return{src:["srcUpdated"]}}};j.style=":host{display:block;width:100%}:host(.group-thumbnail)>img{display:block;aspect-ratio:200 / 133;object-fit:cover}img{display:block;width:100%}.rounded-corners{border-radius:0.75rem}:host(.image-thumbnail)>img{height:16rem;width:100%;object-fit:cover}";const C=class{constructor(i){t(this,i),this.overlayPositioning="fixed",this.placement="auto",this.text=void 0,this.tooltipRef=void 0}render(){return r(s,null,r("div",{ref:t=>this.tooltipRef=t},r("slot",null)),this.text&&this.tooltipRef&&r("calcite-tooltip",{overlayPositioning:this.overlayPositioning,placement:this.placement,referenceElement:this.tooltipRef},this.text))}};export{w as arcgis_hub_card,x as arcgis_hub_group_member_summary,j as arcgis_hub_image,C as arcgis_ref_tooltip}