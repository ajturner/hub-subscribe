import{r as t,c as e,h as i,H as s,a,F as o}from"./p-d4ba4c14.js";import{b as n,c as r,g as c,w as l}from"./p-b728aff4.js";import{a as h,b as d,c as u}from"./p-d1b12a9c.js";import{b as p}from"./p-fd260f2d.js";import{g}from"./p-796574a4.js";import{i as m}from"./p-be5c5009.js";import{d as b}from"./p-8cf4bd83.js";import{S as f}from"./p-b6bf5cf5.js";import{I as v,C as y}from"./p-c29c8d33.js";import{R as w}from"./p-2accb2bf.js";import{c as x}from"./p-24168d21.js";import{M as C}from"./p-3311a06c.js";import{D as k}from"./p-3bf8d293.js";import{A as j}from"./p-c5919bc3.js";import{h as O}from"./p-b1a98ae3.js";import{K as S}from"./p-85d6867e.js";import{g as L}from"./p-ec05d786.js";import{u as _}from"./p-14a66e4a.js";import F from"@arcgis/core/Map.js";import z from"@arcgis/core/views/MapView.js";import M from"@arcgis/core/Basemap.js";import{Point as T,Extent as D}from"@arcgis/core/geometry.js";import R from"@arcgis/core/Graphic.js";import{l as E}from"./p-e16232c9.js";import{watch as I}from"@arcgis/core/core/reactiveUtils.js";import{webMercatorToGeographic as $}from"@arcgis/core/geometry/support/webMercatorUtils.js";import A from"@arcgis/core/widgets/Search.js";import B from"@arcgis/core/geometry/Extent.js";import*as H from"@arcgis/core/geometry/projection.js";import{watch as P}from"@arcgis/core/core/watchUtils.js";import Z from"@arcgis/core/widgets/Zoom/ZoomViewModel.js";import"./p-dcdf7b57.js";import"./p-dfe5a97d.js";import"./p-a0deb8c6.js";import"./p-dd26efbb.js";import"./p-6dcae6cd.js";import"./p-637ea136.js";import"./p-3f64a9d9.js";import"./p-377e1b5e.js";import"./p-2acb70a6.js";import"./p-79674347.js";import"./p-ac9a1e61.js";import"./p-3f2f2acb.js";import"./p-b295a5ae.js";import"./p-8e7f4c22.js";import"./p-d763eacf.js";import"./p-008d72ef.js";import"./p-24ecdf64.js";import"./p-903ef8af.js";import"./p-9b205605.js";import"./p-1458dcfd.js";import"./p-783242bc.js";import"./p-52612356.js";import"./p-af59e67b.js";import"./p-dafb2329.js";import"./p-6f931af6.js";import"./p-56b73d71.js";import"./p-3904125b.js";import"./p-cea8413b.js";import"./p-ad325ed1.js";import"./p-69555c48.js";import"./p-235bb6ee.js";import"./p-992b9d10.js";import"./p-7202c430.js";import"./p-75d6da59.js";import"./p-895b662f.js";import"./p-8dbea197.js";import"./p-59fd2498.js";import"./p-90dc0f6f.js";import"./p-31aebb8c.js";import"./p-aa262d60.js";import"./p-ea6de7f6.js";import"./p-3363f483.js";import"./p-87582fe0.js";import"./p-16a95e5b.js";import"./p-e43616ff.js";import"./p-ca048216.js";import"./p-4a14259a.js";import"./p-c836a9b6.js";import"./p-6d4e51c6.js";import"./p-4c02fe5e.js";import"@arcgis/core/kernel.js";function G(t){return t.split(" ").map((t=>n(t))).join(" ")}function W(t){return"multi-select"===t.display||"single-select"===t.display}function V(t=[]){return t.filter(U)}function U(t){return"date-range"===t.display}function K(t){return"tree"===t.display}function N(t=[]){return t.filter(q)}function q(t){return W(t)||K(t)}function J(t=[]){return t.filter(Q)}function Q(t){return"map"===t.display}function X(t){let e=r(t);switch(t.display){case"single-select":case"multi-select":case"tree":e=function(t){const e=r(t);return e.options.forEach((t=>{t.selected=!1})),"single-select"===e.display&&e.options.length&&(e.options[0].selected=!0),e}(t);break;case"date-range":e=function(t){const e=r(t);return e.value={from:null,to:null},e}(t);break;case"map":e=function(t){const e=r(t);return e.value=null,e}(t)}return e}function Y(t){const e=Object.entries(t).map((([t,e])=>`${t}=${e}`)).join("&");return e&&`?${e}`}function tt(t){return Date.parse(t.from)<Date.parse(t.to)}function et(t){return t.replace(/\(\d+\)/,"").replace("‎","").trim()}const it=class{constructor(i){t(this,i),this.arcgisHubDateRangeFacetChange=e(this,"arcgisHubDateRangeFacetChange",7),this.facet=void 0,p(this,"handleDateRangeChange")}handleDateRangeChange(t){t.preventDefault();const[e,i]=t.target.valueAsDate,s={from:null==e?void 0:e.toISOString(),to:null==i?void 0:i.toISOString()};tt(s)?this.arcgisHubDateRangeFacetChange.emit({key:this.facet.key,value:s}):e||i||this.arcgisHubDateRangeFacetChange.emit({key:this.facet.key,value:{from:null,to:null}})}render(){const t=g(this.facet,"value.from")||null,e=g(this.facet,"value.to")||null,a=new Date;return i(s,{"data-element":"date-range-facet"},i("calcite-input-date-picker",{layout:"horizontal",max:a.toISOString(),onCalciteInputDatePickerChange:this.handleDateRangeChange,range:!0,scale:"s",value:[t,e]}))}};it.style=":host{display:block}calcite-input-date-picker{--calcite-ui-text-1:#151515;--calcite-ui-brand:var(--calcite-ui-text-1);--calcite-ui-foreground-current:var(--calcite-ui-foreground-3);--calcite-ui-foreground-1:#fff;--calcite-ui-foreground-2:#f3f3f3;--calcite-ui-foreground-3:#eaeaea;--calcite-ui-text-3:#6a6a6a;--calcite-ui-border-input:#757575;--calcite-ui-border-2:#4a4a4a;--calcite-font-size--2:.7rem}";const st=class{constructor(e){t(this,e),this.message="No results found."}render(){return i(s,null,i("calcite-icon",{icon:"file-magnifying-glass"}),i("h3",{"aria-live":"polite",role:"status"},this.message))}};st.style=":host{display:flex;flex-direction:column;align-items:center;gap:2rem}calcite-icon{width:auto;height:16rem}";const at=t=>{const e=ot(t),i=ct(e);return 1===i.length?i[0]:e},ot=t=>{const e={label:"root",children:{},option:null};return t.forEach((t=>{const i=t.key.slice(1).split("/");nt(e,t,i)})),e},nt=(t,e,i)=>{if(i.length){const s=i.shift(),a=t.children[s]||{label:s,children:{},option:null};t.children[s]=a,nt(a,e,i)}else t.label=e.label,t.option=e},rt=t=>!!ct(t).length,ct=t=>Object.values(t.children),lt=t=>{const e=t.option.selected;return rt(t)?e&&ct(t).every(lt):e},ht=(t,e)=>(t.option._telemetryIndex=e,i("calcite-tree-item",{"data-key":t.option.key,selected:t.option.selected},i("div",{class:"option-label"},t.label),rt(t)&&i("calcite-tree",{slot:"children"},ct(t).map((t=>ht(t,e)))))),dt=t=>{const e=t.split("/");return e[e.length-1]},ut=t=>{const e=t.options.filter((t=>!t._unrecognized)),i=at(e),s=ct(i).map((e=>pt(t,e))).flat();return[...t.options.filter((t=>t.selected&&t._unrecognized)).map((e=>({key:t.key,label:t.label,optionKey:e.key,optionLabel:e.label}))),...s]};function pt(t,e){let i=[];return e.option.selected&&i.push({key:t.key,label:t.label,optionKey:e.option.key,optionLabel:et(e.option.label)}),lt(e)||ct(e).forEach((e=>{const s=pt(t,e);i=i.concat(s)})),i}const gt=class{constructor(i){t(this,i),this.arcgisHubFacetListChange=e(this,"arcgisHubFacetListChange",7),this.arcgisHubFacetListReset=e(this,"arcgisHubFacetListReset",7),this.hubTelemetry=e(this,"hubTelemetry",7),this.showChips=!1,this.facets=[],this.disableTelemetry=!1,this.resultsCount=void 0,p(this,"resetFacets","onChipClose")}async componentWillLoad(){this.intl=await m.loadIntlForComponent(this.element)}maybeSendTelemetry(t){this.disableTelemetry||this.hubTelemetry.emit(t)}onListFacetChange(t){t.preventDefault(),this.maybeSendTelemetry(Object.assign(Object.assign({},b.dictionary.category.interaction.action.search.label.filter),{details:t.detail.checked?`${t.detail.key}: ${t.detail.optionKey}`:`${t.detail.key}: Removed ${t.detail.optionKey}`,element:t.detail.key,position:t.detail.optionIndex}));const e=function(t=[]){return t.filter(W)}(this.facets).find((e=>e.key===t.detail.key));e.options=e.options.map((i=>(i.key===t.detail.optionKey?i.selected=t.detail.checked:"single-select"===e.display&&(i.selected=!1),i))),this.arcgisHubFacetListChange.emit(e)}onTreeFacetChange(t){const e=function(t=[]){return t.filter(K)}(this.facets).find((e=>e.key===t.detail.key)),{optionKeys:i}=t.detail,s=i.map(dt).join(", ");this.maybeSendTelemetry(Object.assign(Object.assign({},b.dictionary.category.interaction.action.search.label.filter),{details:t.detail.selected?`${t.detail.key}: ${s}`:`${t.detail.key}: Removed ${s}`,element:t.detail.key,position:t.detail.topLevelIndex})),e.options=e.options.map((e=>(i.includes(e.key)&&(e.selected=t.detail.selected),e))),this.arcgisHubFacetListChange.emit(e)}onDateRangeFacetChange(t){const{detail:{key:e,value:i}}=t,s=V(this.facets).find((t=>t.key===e));tt(i)&&this.maybeSendTelemetry(Object.assign(Object.assign({},b.dictionary.category.interaction.action.search.label.filter),{details:b.constants.details.DATE_UPDATED,element:s.key})),s.value=i,this.arcgisHubFacetListChange.emit(s)}onMapFacetChange(t){const{detail:{key:e,value:i}}=t,s=J(this.facets).find((t=>t.key===e));s.value=i,this.arcgisHubFacetListChange.emit(s)}onChipClose(t){const e=this.facets.findIndex((e=>e.key===t.key)),{updatedFacet:i,dismissedKeys:s}=((t,e)=>{let i;switch(t.display){case"single-select":i=((t,e)=>{const i=r(t);return i.options.find((t=>t.key===e.optionKey&&t._unrecognized)).selected=!1,i.options.find((t=>!t._unrecognized)).selected=!0,{updatedFacet:i,dismissedKeys:[e.optionKey]}})(t,e);break;case"multi-select":i=((t,e)=>{const i=r(t);return i.options.forEach((t=>{t.key===e.optionKey&&(t.selected=!1)})),{updatedFacet:i,dismissedKeys:[e.optionKey]}})(t,e);break;case"tree":i=((t,e)=>{const i=r(t),s=i.options.find((t=>t.key===e.optionKey));let a=[],o=!1;s._unrecognized||(a=i.options.filter((t=>!t._unrecognized&&t.key!==e.optionKey&&t.key.includes(e.optionKey))),o=!!a.length&&a.every((t=>t.selected)));const n=[];return s.selected=!1,n.push(s.key),o&&a.forEach((t=>{t.selected=!1,n.push(t.key)})),{updatedFacet:i,dismissedKeys:n}})(t,e)}return i})(this.facets[e],t);var a,o;this.maybeSendTelemetry(Object.assign(Object.assign({},b.dictionary.category.interaction.action.search.label.filter),{details:`${i.key}: Removed ${a=i,o=s,(K(a)?o.map(dt):o).join(", ")}`,element:b.constants.element.CHIPS})),this.facets[e]=i,this.arcgisHubFacetListChange.emit(i)}resetFacets(){this.arcgisHubFacetListReset.emit()}get chips(){return this.facets.reduce(((t,e)=>{let i=[];switch(e.display){case"single-select":i=(t=>t.options.filter((t=>t.selected&&t._unrecognized)).map((e=>({key:t.key,label:t.label,optionKey:e.key,optionLabel:e.label}))))(e);break;case"multi-select":i=(t=>t.options.filter((t=>t.selected)).map((e=>{const i=et(e.label);return{key:t.key,label:t.label,optionKey:e.key,optionLabel:i}})))(e);break;case"tree":i=ut(e)}return[...t,...i]}),[])}renderFacets(){return this.facets.map((t=>!q(t)||t.options.length>1?i("calcite-accordion-item",{expanded:"closed"!==t.state,heading:t.label,"is-map":Q(t),key:t.key},this.renderFacetComponent(t),this.renderFacetTooltip(t)):null))}renderFacetComponent(t){switch(t.display){case"single-select":case"multi-select":return i("arcgis-hub-facet-options",{"data-test":t.key,facet:t});case"date-range":return i("arcgis-hub-date-range-facet",{"data-test":t.key,facet:t});case"tree":return i("arcgis-hub-tree-facet",{"data-test":t.key,facet:t});case"map":return i("arcgis-hub-map-facet",{"data-test":t.key,facet:t,resultsCount:this.resultsCount})}}renderFacetTooltip(t){const e=`popover-toggle-${t.key}`;return t.tooltip&&i("div",{slot:"actions-end"},i("calcite-action",{appearance:"transparent",icon:"information-f",id:e,label:"info tooltip",scale:"s"}),i("calcite-tooltip",{label:`${t.key} info`,overlayPositioning:"fixed",placement:"bottom-end",referenceElement:e},i("span",{class:"facet-popover-content"},t.tooltip)))}renderChips(){return this.chips.map((t=>{const e=`${t.label}: ${t.optionLabel}`,s=this.onChipClose.bind(this,t);return i("calcite-chip",{closable:!0,"data-test":e,key:t.optionKey,onCalciteChipClose:s,scale:"m",value:e},e)}))}render(){if(this.facets.length)return i(s,null,i("div",{class:"header-container",id:"filters-header"},i("calcite-button",{appearance:"transparent","aria-labelledby":"filters-header",class:"reset-facets-button",color:"blue",onClick:this.resetFacets},this.intl.t("reset")),i("slot",{name:"header"})),this.showChips?this.renderChips():"",i("calcite-accordion",{appearance:"transparent",scale:"l"},i("div",{class:"additional-facet-container"},i("slot",{name:"additional-facet"})),this.renderFacets()))}static get assetsDirs(){return["locales"]}get element(){return a(this)}};gt.style=":host{display:block}.header-container{display:flex;flex-direction:row-reverse;align-items:center;justify-content:space-between}.header-container calcite-button{font-size:1rem}calcite-accordion{--calcite-accordion-item-padding:var(--calcite-accordion-item-spacing-unit) 0rem}calcite-accordion-item{border-width:0px;border-top-width:1px;border-style:solid;border-color:var(--calcite-ui-border-2)}@media (max-width: 1200px){calcite-accordion-item[is-map]{display:none}}calcite-chip{margin-bottom:0.5rem;max-width:100%}calcite-chip:nth-last-of-type(1){margin-bottom:1.25rem}.reset-facets-button{--calcite-font-size--1:var(--hub-gallery-font-size-large)}.additional-facet-container{--calcite-font-size--1:var(--calcite-font-size-0)}.facet-popover-content{text-align:center;font-weight:var(--calcite-font-weight-light);font-size:1rem}calcite-tooltip{max-width:13rem}.facet-popover-trigger{margin-inline-start:.375rem}";const mt=class{constructor(i){t(this,i),this.arcgisHubFacetOptionsChange=e(this,"arcgisHubFacetOptionsChange",7),this.arcgisHubFacetMoreLessClicked=e(this,"arcgisHubFacetMoreLessClicked",7),this.pageSize=5,this.facet=void 0,this.showLimitedOptions=!1,this.query="",p(this,"handleCalciteRadioButtonChangeEvent","handleCalciteCheckboxChangeEvent","toggleMoreOrLessButton","handleCalciteInputInput","setPageSeparator")}async componentWillLoad(){this.facet.optionLimit&&(this.pageSize=this.facet.optionLimit),this.intl=await m.loadIntlForComponent(this.element),this.facet.options.length>this.pageSize&&(this.showLimitedOptions=!0)}handleCalciteInputInput(t){this.query=t.target.value}handleCalciteRadioButtonChangeEvent(t){this.onFacetChanged(t.target.id,t.target.checked)}handleCalciteCheckboxChangeEvent(t,e){this.onFacetChanged(e.target.id,e.target.checked,t)}onFacetChanged(t,e,i){this.arcgisHubFacetOptionsChange.emit({key:this.facet.key,optionKey:t,checked:e,optionIndex:i})}get filteredOptions(){return this.facet.options.filter((({_unrecognized:t,label:e})=>!t&&e.toLowerCase().includes(this.query.toLowerCase())))}get orderedOptions(){return this.filteredOptions.sort("label"===this.facet.orderBy?(t,e)=>t.label.localeCompare(e.label):(t,e)=>{var i,s;return(null!==(i=e.count)&&void 0!==i?i:0)-(null!==(s=t.count)&&void 0!==s?s:0)})}setPageSeparator(t){this.pageSeparator=t}renderCheckboxes(){const t=this.orderedOptions.map(((t,e)=>{const s=t.count?`${t.key}:${t.count}`:t.key,a=this.handleCalciteCheckboxChangeEvent.bind(this,e);return i("calcite-label",{key:s},i("div",{class:"option-container"},i("calcite-checkbox",{checked:t.selected,id:t.key,name:t.label,onCalciteCheckboxChange:a}),i("span",{class:"option"},t.label)))})),e=t.slice(0,this.pageSize),s=this.showLimitedOptions?[]:t.slice(this.pageSize);return[...e,i("span",{key:"page-separator",ref:this.setPageSeparator,tabIndex:-1}),...s]}toggleMoreOrLessButton(){this.arcgisHubFacetMoreLessClicked.emit({facet:this.facet,isMore:this.showLimitedOptions}),this.showLimitedOptions=!this.showLimitedOptions,this.renderCheckboxes(),this.pageSeparator.focus()}get optionsLeftToDisplay(){return this.filteredOptions.length-this.pageSize}get moreOrLessButtonIconEnd(){return this.showLimitedOptions?"chevron-down":"chevron-up"}get moreOrLessButtonLabel(){return this.showLimitedOptions?this.intl.t("showMore",{num:this.optionsLeftToDisplay}):this.intl.t("showLess")}renderMoreOrLessButton(){if("multi-select"===this.facet.display&&this.filteredOptions.length>this.pageSize)return i("div",{class:"more-or-less-container"},i("calcite-button",{appearance:"transparent",color:"blue","icon-end":this.moreOrLessButtonIconEnd,onClick:this.toggleMoreOrLessButton},this.moreOrLessButtonLabel))}renderRadioButtons(){return this.facet.options.filter((t=>!t._unrecognized)).map((t=>i("calcite-label",{key:t.key,layout:"inline"},i("calcite-radio-button",{checked:t.selected,id:t.key,name:t.label,onCalciteRadioButtonChange:this.handleCalciteRadioButtonChangeEvent,value:t.key}),i("span",{class:"option"},t.label))))}renderNoMatchesNotice(){return"multi-select"===this.facet.display&&!this.filteredOptions.length&&i("calcite-notice",{id:"no-match-notice",open:!0,width:"full"},i("div",{slot:"message"},this.intl.t("noMatchesNotice")))}render(){const t="multi-select"===this.facet.display;return i(s,{"data-element":"facet-options"},t&&i("calcite-input",{"aria-label":this.intl.t("inputAriaLabel"),"aria-labelledby":"no-match-notice",class:"option-search-bar",clearable:!0,onCalciteInputInput:this.handleCalciteInputInput,placeholder:this.intl.t("inputPlaceholder")}),t?i("fieldset",{"data-test":"options-container"},i("legend",null,this.facet.label),this.renderCheckboxes()):i("calcite-radio-button-group",{"data-test":"options-container",layout:"vertical",name:"facet-group"},this.renderRadioButtons()),this.renderMoreOrLessButton(),this.renderNoMatchesNotice())}static get assetsDirs(){return["locales"]}get element(){return a(this)}};mt.style=":host{display:block}calcite-input{--calcite-ui-foreground-1:var(--hub-gallery-input-background);--calcite-ui-text-1:var(--hub-gallery-input-text)}.option-search-bar{margin-bottom:0.75rem}.option{line-height:normal;overflow-wrap:anywhere;-webkit-hyphens:auto;hyphens:auto}.option-container{display:flex;gap:0.5rem}.option-container calcite-checkbox{margin-top:0.125rem}calcite-radio-button-group>calcite-label,fieldset>calcite-label{--calcite-font-size--1:var(--calcite-font-size-0)}fieldset{border:0px;padding:0px}legend{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}@media (max-width: 576px){calcite-label{padding-top:0.5rem}calcite-label{padding-bottom:0.5rem}}.more-or-less-container{width:100%;display:flex;flex-direction:row-reverse}";var bt=function(t,e,i,s){var a,o=arguments.length,n=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,s);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(n=(o<3?a(n):o>3?a(e,i,n):a(e,i))||n);return o>3&&n&&Object.defineProperty(e,i,n),n};const ft={channel:[],item:[],group:[],user:[],portalUser:[],communityUser:[],groupMember:[],event:[]},vt=class{constructor(s){t(this,s),this.hubTelemetry=e(this,"hubTelemetry",7),this.arcgisHubGallerySelect=e(this,"arcgisHubGallerySelect",7),this.arcgisHubGalleryQueryChange=e(this,"arcgisHubGalleryQueryChange",7),this.arcgisHubGalleryStateChange=e(this,"arcgisHubGalleryStateChange",7),this.arcgisHubGalleryResultsChange=e(this,"arcgisHubGalleryResultsChange",7),this.arcgisHubGalleryAction=e(this,"arcgisHubGalleryAction",7),this.arcgisHubContentGalleryFacetModalClose=e(this,"arcgisHubContentGalleryFacetModalClose",7),this.arcgisHubGalleryBulkAction=e(this,"arcgisHubGalleryBulkAction",7),this.getCardLayout=(t,e,i)=>{let s="list"===t?"row":"card";if("grid-filled"===t){const t=i%this.gridColumns,a=e>=i-t;t<2&&a&&(s="row")}return s},this.renderBulkAction=t=>{const e={active:t.loading,icon:t.icon,key:t.key,loading:t.loading,text:t.text,textEnabled:!0};return t.name&&!t.children?i("calcite-action",Object.assign({onClick:t.handler},e)):t.children?i("calcite-dropdown",{width:"m"},i("calcite-action",Object.assign({},e,{slot:"trigger"})),i("calcite-dropdown-group",{selectionMode:"none"},t.children.map((t=>i("calcite-dropdown-item",{key:t.key,onCalciteDropdownItemSelect:t.handler},i("div",null,i("div",null,t.text),i("div",null,t.helperText))))))):void 0},this.context=void 0,this._context=void 0,this.portal="https://www.arcgis.com",this.term=void 0,this.baseUrl=void 0,this.linkTarget="self",this.site=void 0,this.limit=10,this.sortField=null,this.sortOrder=null,this.sortByIds=void 0,this.layout="list",this.showThumbnail=!0,this.imageType=v.thumbnail,this.lazy=!1,this.showSort=!1,this.showSearch=!1,this.showChips=!1,this.showFacets=!1,this.newTab=!1,this.selectionMode="none",this.bulkActions={position:"bottom",actions:[]},this.showMoreResultsBtn=!1,this.showResultsCount=!1,this.showBackToTopBtn=!1,this.query=void 0,this.facets=void 0,this.galleryType=void 0,this.cardTitleTag=void 0,this.include="",this.state={},this.corners=y.square,this.showAdditionalInfo=!0,this.showEmptyState=!0,this.disableTelemetry=!1,this.shadow=void 0,this.showLinkButton=!1,this.linkButtonText=void 0,this.linkButtonStyle=void 0,this.mobileView=!1,this.showFacetModal=!1,this.showBadges=!0,this.showType=!0,this.showOwner=!0,this.showLayoutSwitcher=!1,this.clickableCards=!1,this.additionalFacet=void 0,this.gallerySelection=void 0,this._gallerySelection=void 0,this.showSelection=!1,this.cardActionLinks=[],this.sortOptions=void 0,this.isInitialized=!1,this.actions=[],this.searchResults=[],this.gridColumns=4,p(this,"changeSortField","fetchMore","actionHandler","handleResize","forceModalClose","onFacetModalClose","onFacetChange","resetFacets","backToTop","setResultTopSpan","logGalleryActionsTelemetry","setBottomSpan")}get _include(){return this.include?this.include.split("|"):[]}get _activeSortOption(){const t=this.sortField,e=this._sortOptions.find((e=>e.attribute===t));return e&&Object.assign(Object.assign({},e),{order:this.sortOrder})}async handleResize(){const t=this.element.clientWidth;let e=1;t>1090?e=4:t>810?e=3:t>530&&(e=2),this.element.style.setProperty("--columns",`${e}`),this.gridColumns=e}async componentWillLoad(){this.intl=await m.loadIntlForComponent(this.element),this.initialize()}async initialize(){if(this.isInitialized=!1,delete this.element.dataset.testReady,this._context=this.context,!this._context&&this.portal){const t=await j.create({portalUrl:this.portal});this._context=t.context}this.query||(this.query={targetEntity:this.galleryType||"item",filters:[{predicates:[{term:this.term}]}]}),this.setSortOptions(this.sortOptions),this.gallerySelection&&Object.entries(this.gallerySelection).length||(this.gallerySelection=r(ft)),this.facets&&await this.fetchDynamicFacetOptions(),Object.keys(this.state).length>0&&this.applySerializedState(this.state),this.arcgisHubGalleryStateChange.emit(this.serializedGalleryState),this._gallerySelection=r(this.gallerySelection),this.prepareAndExecuteSearch()}connectedCallback(){"grid-filled"===this.layout&&w.addHandler(this.element,this.handleResize)}disconnectedCallback(){w.unobserve(this.element)}async handleContextChange(){this._context=this.context,this.facets&&await this.fetchDynamicFacetOptions(),this.prepareAndExecuteSearch()}async fetchFacetsAndSearch(){this.facets&&(await this.fetchDynamicFacetOptions(),this.applySerializedState({}),this.arcgisHubGalleryStateChange.emit(this.serializedGalleryState)),this.prepareAndExecuteSearch()}prepareAndExecuteSearch(){this.search(this.activeQuery,this._searchOptions)}onStateChanged(){var t,e;t=this.serializedGalleryState,e=this.state,Object.keys(e).some((i=>null===e[i]?e[i]!=t[i]:e[i]!==t[i]))&&(this.applySerializedState(this.state),this.prepareAndExecuteSearch())}onGallerySelectionChanged(t){this._gallerySelection=Object.assign({},t)}async refresh(){const t=Object.assign(Object.assign({},this._searchOptions),{num:this.searchResults.length});this.search(this.activeQuery,t)}async clearSelection(){this.gallerySelection=r(ft)}setResultTopSpan(t){this.resultTopSpan=t}setBottomSpan(t){t&&(this.resultBottomSpan=t)}applySerializedState(t){const e=function(t,e){const i=r(t);return e.query?i.query=e.query:null===e.query&&(i.query=""),i.sort=function(t,e){const i=r(t);if(e){const[t,s,a]=e.split("|");i.label=t,i.attribute=s,i.order=a}else null===e&&(i.attribute=null,i.order=null);return i}(i.sort,e.sort),i.facets=i.facets.map((t=>{if(e[t.key]){const i={};return i[t.key]=e[t.key],function(t,e){let i=r(t);switch(t.display){case"single-select":case"multi-select":i=function(t,e){const i=r(t),s=e[t.key];let a=[];return s&&(a=("single-select"===t.display?[s]:s.split(",")).map((t=>t.split("|").join(",")))),i.options.forEach((t=>t.selected=!1)),a.forEach((e=>{const s=i.options.find((t=>t.key===e));s?s.selected=!0:i.options.push({label:e,key:e,selected:!0,_unrecognized:!0,predicates:[{[t.key]:e}]})})),i.options=i.options.map((t=>(t.selected=a.includes(t.key),t))),i}(t,e);break;case"tree":i=function(t,e){const i=r(t),s=e[t.key],a=(s?s.split(","):[]).map((t=>t.split("|").join(",")));return i.options.forEach((t=>t.selected=!1)),a.forEach((e=>{const s=i.options.filter((t=>t.key.endsWith(e)));if(s.length)s.forEach((t=>t.selected=!0));else{const s=e.split("/");i.options.push({label:s[s.length-1],key:e,selected:!0,_unrecognized:!0,predicates:[{[t.key]:e}]})}})),i}(t,e);break;case"date-range":i=function(t,e){var i;const s=r(t),[a,o]=(null===(i=e[t.key])||void 0===i?void 0:i.split("|"))||[],n={from:a,to:o};return tt(n)&&(s.value=n),s}(t,e);break;case"map":i=function(t,e){const i=r(t);return i.value=function(t){let e=null;const i=t.split(",").map(Number);if(4===i.length&&i.every((t=>!isNaN(t)))){const[t,s,a,o]=i;e=[[t,s],[a,o]]}return e}(e[t.key]||""),i}(t,e)}return i}(t,i)}return X(t)})),i}(this.galleryState,t);e.query!==this.term&&(this.term=e.query),e.sort&&(this.sortField=e.sort.attribute,this.sortOrder=e.sort.order),e.facets&&(this.facets=e.facets)}get _aggFieldBatches(){const t=N(this.facets).reduce(((t,e)=>(e.field&&t.push(e.field),t)),[]),e=[];for(let i=0;i<t.length;i+=3)e.push(t.slice(i,i+3));return e}get _aggLimit(){return N(this.facets).reduce(((t,e)=>(e.aggLimit&&e.aggLimit>t&&(t=e.aggLimit),t)),10)}get hasSearchResults(){return this.lastSearchResponse&&!!this.searchResults.length}get activeFacetFilters(){const t=[];return N(this.facets).forEach((e=>{const i=e.options.reduce(((t,e)=>(e.selected&&(t=[...t,...e.predicates]),t)),[]);i.length&&t.push({operation:e.operation,predicates:i})})),t}get activeDateRangeFilters(){const t=[];return V(this.facets||[]).forEach((e=>{if(e.value&&tt(e.value)){const i={from:Date.parse(e.value.from),to:Date.parse(e.value.to)};t.push({operation:"OR",predicates:[{[e.field]:i}]})}})),t}get activeMapFilters(){const t=[];return J(this.facets||[]).forEach((e=>{if(e.value){const i={operation:"OR",predicates:[{[e.field]:h(e.value)}]};t.push(i)}})),t}async fetchDynamicFacetOptions(){if(this._aggSearchOptionBatches.length)try{const t=this._aggSearchOptionBatches.map((t=>O(this.query,t)));(await Promise.all(t)).reduce(((t,{aggregations:e})=>{if(e){const i=x(e);t=t.concat(i)}return t}),[]).forEach((t=>{const e=N(this.facets).find((e=>e.field===t.field));if(e){const i=function(t,e){let i=r(t.options);switch(t.field){case"type":i=i.map((t=>{const e=["csv","pdf","kml","wfs","wms"].includes(t.key)?t.key.toUpperCase():G(t.key);return t.label=e,t.key=e,t.predicates=[{type:e}],t}));break;case"access":i=i.map((t=>{const i=t.label.toLowerCase();return t.label=e.t(`facets.access.${i}`),t}));break;case"categories":i=i.map((t=>{const e=t.label.split("/");return t.label=G(e[e.length-1]),t}));break;case"tags":i=i.map((t=>(t.label=G(t.label),t)));break;case"license":i=i.map((t=>(t.label=["none","custom"].includes(t.key)?e.t(`facets.license.${t.key}`):t.label.replace(/-/g," "),t)))}return i=i.map((t=>(t.label=function(t,e,i){return null==e?t:"rtl"===i.direction?`‎(${e}) ${t}`:`${t} (${e})`}(t.label,t.count,e),t))),i}(t,this.intl);e.options="categories"===e.key?i.filter((t=>t.key.startsWith("/categories"))):i}})),this.facets=this.facets.map((t=>r(t)))}catch(t){throw new Error(`Error loading facet options: ${t}`)}}async search(t,e){try{const i=await O(t,e);this.lastSearchResponse=i,this.arcgisHubGalleryResultsChange.emit(i.results);const{sortByIds:s}=this;let a=i.results;s&&s.length&&(a=i.results.slice().sort(((t,e)=>(s.includes(t.id)?s.indexOf(t.id):1/0)-(s.includes(e.id)?s.indexOf(e.id):1/0)))),this.searchResults=a,this.isInitialized=!0,this.element.dataset.testReady=""}catch(t){throw new Error(`Error loading results: ${t}`)}}async fetchMore(){const t=Math.ceil(this.searchResults.length/this.limit);this.maybeSendTelemetry(Object.assign(Object.assign({},b.dictionary.category.interaction.action.search.label.loadMore),{search:Y(this.serializedGalleryState),element:b.constants.element.RESULTS_LIST,position:t,count:this.lastSearchResponse.total}));try{this.lastSearchResultsTotal=this.searchResults.length,this.resultBottomSpan.focus({preventScroll:!0}),this.lastSearchResponse=await this.lastSearchResponse.next(),this.searchResults=[...this.searchResults,...this.lastSearchResponse.results]}catch(t){console.error(`Unable to fetch more results: ${t}`)}}backToTop(){this.maybeSendTelemetry(Object.assign(Object.assign({},b.dictionary.category.interaction.action.search.label.backToTop),{element:b.constants.element.BACK_TO_TOP})),this.resultTopSpan.focus({preventScroll:!0}),this.element.parentElement?this.element.parentElement.scrollIntoView({behavior:"smooth"}):this.element.scrollIntoView({behavior:"smooth"})}get activeQuery(){const t=r(this.query);if(this.term&&t.filters.push({predicates:[{term:this.term}]}),this.activeFacetFilters.length&&(t.filters=[...t.filters,...this.activeFacetFilters]),this.activeDateRangeFilters.length&&(t.filters=[...t.filters,...this.activeDateRangeFilters]),this.activeMapFilters.length&&(t.filters=[...t.filters,...this.activeMapFilters]),t.filters.length||"user"!==this.query.targetEntity||t.filters.push({predicates:[{term:""}]}),!this.showSelection&&this.gallerySelection&&c(Object.values(this.gallerySelection)).length)for(const[e,i]of Object.entries(this.gallerySelection))if(e===t.targetEntity){let s="id";"communityUser"!==e&&"portalUser"!==e&&"groupMember"!==e&&"user"!==e||(s="username"),t.filters.push({predicates:[{[s]:{not:[...i]}}]})}return t}get _searchOptions(){var t;return{num:this.limit,sortField:this.sortField,sortOrder:f[this.sortOrder],include:this._include,requestOptions:null===(t=this._context)||void 0===t?void 0:t.hubRequestOptions,site:this.site}}get _aggSearchOptionBatches(){var t;const e={num:1,include:[],requestOptions:null===(t=this._context)||void 0===t?void 0:t.hubRequestOptions,aggLimit:this._aggLimit,site:this.site},i=[];return this._aggFieldBatches.forEach((t=>{i.push(Object.assign(Object.assign({},e),{aggFields:t}))})),i}get galleryState(){return{query:this.term,sort:this._activeSortOption,facets:this.facets,layout:this.layout}}get serializedGalleryState(){return S(function(t){var e;const i={};var s;t.query&&(i.query=t.query),(null===(e=t.sort)||void 0===e?void 0:e.attribute)&&(i.sort=`${(s=t.sort).label}|${s.attribute}|${s.order}`),t.layout&&(i.layout=t.layout);const a=(t.facets||[]).reduce(((t,e)=>Object.assign(Object.assign({},t),function(t){let e={};switch(t.display){case"single-select":case"multi-select":case"tree":e=function(t){const e={},i=t.options.filter((t=>t.selected)).map((t=>t.key.split(",").join("|"))),s="single-select"===t.display?i[0]:i.join(",");return e[t.key]=s||null,e}(t);break;case"date-range":e=function(t){var e,i;const s={},a=null===(e=t.value)||void 0===e?void 0:e.from,o=null===(i=t.value)||void 0===i?void 0:i.to;return s[t.key]=a&&o?`${a}|${o}`:null,s}(t);break;case"map":e=function(t){return{[t.key]:t.value&&h(t.value)}}(t)}return e}(e))),{});return Object.assign(Object.assign({},i),a)}(this.galleryState))}get _hasSlottedGalleryActions(){return!!this.element.querySelector('[slot="gallery-actions"]')}get resultContainerClass(){return["card-container",`cols-${this.gridColumns}`].join(" ")}handleLayoutSelect(t){var e;this.layout=t.detail,this.maybeSendTelemetry(Object.assign(Object.assign({},b.dictionary.category.interaction.action.search.label.view),{element:b.constants.element.VIEW_BUTTON,details:`${G(this.layout)} View`,search:Y(this.serializedGalleryState),count:(null===(e=this.lastSearchResponse)||void 0===e?void 0:e.total)||0})),this.arcgisHubGalleryStateChange.emit(this.serializedGalleryState)}sendCardTitleClickTelemetry(t){var e;const{model:i}=t.detail;this.maybeSendTelemetry(Object.assign(Object.assign({},b.dictionary.category.interaction.action.search.label.click),{type:i.type,search:Y(this.serializedGalleryState),element:b.constants.element.RESULTS_LIST,position:i.index,count:null===(e=this.lastSearchResponse)||void 0===e?void 0:e.total}))}sendMoreLessClickTelemetry(t){const{facet:e,isMore:i}=t.detail;this.maybeSendTelemetry(Object.assign(Object.assign({},b.dictionary.category.interaction.action.search.label.filter),{details:i?b.constants.details.MORE:b.constants.details.LESS,search:Y(this.serializedGalleryState),element:e.key,count:this.lastSearchResponse.total}))}handleSearchChange(t){t.stopPropagation(),this.term!==t.detail&&(this.term=t.detail,this.arcgisHubGalleryStateChange.emit(this.serializedGalleryState),this.maybeSendTelemetry(Object.assign(Object.assign({},b.dictionary.category.interaction.action.search.label.query),{details:Y(this.serializedGalleryState),search:this.term,element:b.constants.element.ON_PAGE})))}onFacetChange(t){t.stopPropagation();const e=t.detail,i=this.facets.map((t=>t.key===e.key?r(e):t));this.facets=i,this.arcgisHubGalleryStateChange.emit(this.serializedGalleryState),this.prepareAndExecuteSearch()}cardSelect(t){t.stopPropagation();const e=this._gallerySelection[this.query.targetEntity];this._gallerySelection[this.query.targetEntity]=e.includes(t.detail.id)?l(e,t.detail.id):"single"===this.selectionMode?[t.detail.id]:[...e,t.detail.id],this._gallerySelection=r(this._gallerySelection),this.arcgisHubGallerySelect.emit(this._gallerySelection)}resetFacets(){var t;this.hubTelemetry.emit(Object.assign(Object.assign({},b.dictionary.category.interaction.action.search.label.filter),{details:b.constants.details.RESET,search:Y(this.serializedGalleryState),element:b.constants.element.RESET_FILTERS,count:null===(t=this.lastSearchResponse)||void 0===t?void 0:t.total})),this.facets=this.facets.map(X),this.arcgisHubGalleryStateChange.emit(this.serializedGalleryState),this.prepareAndExecuteSearch()}maybeSendTelemetry(t){this.disableTelemetry||this.hubTelemetry.emit(t)}changeSortField(t){this.sortField=t.detail.attribute,this.sortOrder=t.detail.order,this.arcgisHubGalleryStateChange.emit(this.serializedGalleryState),this.prepareAndExecuteSearch()}renderSearch(){if(this.showSearch)return i("arcgis-hub-search-input",{class:"search-bar",placeholder:this.intl.t("search"),scale:"l",text:this.intl.t("search"),value:this.term})}renderLayoutSwitcher(){if(this.showLayoutSwitcher&&!this.mobileView){const t=[{tooltip:this.intl.t("layoutOptions.grid"),layout:"grid",icon:"grid"},{tooltip:this.intl.t("layoutOptions.list"),layout:"list",icon:"list"}];return i("div",{class:"layout-switcher-container"},t.map((t=>i("arcgis-hub-layout-button",{class:"layout-option",icon:t.icon,key:t.layout,layout:t.layout,selected:this.layout===t.layout,tooltip:t.tooltip}))))}}renderMoreResultsBtn(){var t;if(this.showMoreResultsBtn&&(null===(t=this.lastSearchResponse)||void 0===t?void 0:t.hasNext))return i("calcite-button",{onClick:this.fetchMore},this.intl.t("moreResults"))}renderBackToTopBtn(){if(this.showBackToTopBtn&&this.hasSearchResults)return i("calcite-button",{appearance:"outline",class:"back-to-top-btn",onClick:this.backToTop},this.intl.t("backToTop"))}setSortOptions(t){const e={relevance:{attribute:null,label:"Relevance",defaultOrder:null,order:null},title:{attribute:"title",label:"Title",defaultOrder:"asc",order:"asc"},created:{attribute:"created",label:"Date Created",defaultOrder:"desc",order:"desc"},modified:{attribute:"modified",label:"Date Updated",defaultOrder:"desc",order:"desc"},username:{attribute:"username",label:"Username",defaultOrder:"asc",order:"asc"},joined:{attribute:"joined",label:"Date Joined",defaultOrder:"desc",order:"desc"},memberType:{attribute:"membertype",label:"Role",defaultOrder:"desc",order:"desc"}};this._sortOptions=(t=t||["relevance","title","created","modified"]).map((t=>e[t]))}renderSort(){if(this.showSort&&this.hasSearchResults)return i("arcgis-hub-search-sort",{activeSortOption:this._activeSortOption,class:"search-sort",onHubSearchSortChange:this.changeSortField,sortOptions:this._sortOptions})}async forceModalClose(){this.showFacetModal=!1}onFacetModalClose(t){t.stopPropagation(),this.arcgisHubContentGalleryFacetModalClose.emit()}renderFacets(){if(this.showFacets)return this.mobileView?this.renderMobileFacets():this.renderDesktopFacets(this.facets)}renderDesktopFacets(t){var e;return i("arcgis-hub-facet-list",{disableTelemetry:this.disableTelemetry,facets:t,onArcgisHubFacetListChange:this.onFacetChange,onArcgisHubFacetListReset:this.resetFacets,resultsCount:(null===(e=this.lastSearchResponse)||void 0===e?void 0:e.total)||0,showChips:this.showChips},i("div",{slot:"additional-facet"},this.additionalFacet),this.mobileView?"":i("h2",{class:"facet-list-header",slot:"header"},this.intl.t("filter")))}renderMobileFacets(){var t;const e=this.facets.map((t=>r(Object.assign(Object.assign({},t),{accordionClosed:!1}))));return i("arcgis-wormhole",null,i("calcite-modal",{onCalciteModalClose:this.onFacetModalClose,open:this.showFacetModal},i("span",{slot:"header"},this.intl.t("filter")),i("div",{slot:"content"},this.renderDesktopFacets(e)),i("calcite-button",{onClick:this.forceModalClose,slot:"primary",width:"full"},this.intl.t("viewResults",{numResults:null===(t=this.lastSearchResponse)||void 0===t?void 0:t.total}))))}getCardComponentName(t){let e="arcgis-hub-generic-card";switch(t){case"Hub Project":e="arcgis-hub-project-card";break;case"Hub Initiative":e="arcgis-hub-initiative-card";break;case"channel":e="arcgis-hub-channel-card";break;case"User":e="arcgis-hub-user-card"}return e}actionHandler(t){this.arcgisHubGalleryAction.emit(t.detail)}renderSkeletons(){let t=1;this.showType||this.showOwner&&t++,"list"!==this.layout&&t++;const e=[...Array(this.limit).keys()].map((e=>i("arcgis-skeleton-loader",{active:!0,headingRows:t,key:e,rows:3,showHeading:!0,showThumbnail:"list"!==this.layout},this.showLinkButton&&i("div",{class:"loading-link-button"}))));return i(o,null,e)}renderList(t){let e;if(t.length){const s=t.map(((e,s)=>{const a=this._gallerySelection[this.query.targetEntity].includes(e.id);e.index=s;const o=[...this.cardActionLinks];this.showLinkButton&&o.unshift({label:this.linkButtonText,showLabel:!0,href:L(e,this.linkTarget,this.baseUrl),buttonStyle:this.linkButtonStyle});const n=this.getCardComponentName(e.type);return i(n,{actionLinks:o,baseUrl:this.baseUrl,class:"arcgis-hub-entity-card",clickable:this.clickableCards,corners:this.corners,"data-test":e.name,imageType:this.imageType,key:e.id,layout:this.getCardLayout(this.layout,s,t.length),lazy:this.lazy,linkTarget:this.linkTarget,newTab:this.newTab,searchResult:e,selectable:this.selectable,selected:a,shadow:this.shadow,showAdditionalInfo:this.showAdditionalInfo,showBadges:this.showBadges,showOwner:this.showOwner,showThumbnail:this.showThumbnail,showType:this.showType,titleTag:this.cardTitleTag})})),a=i("span",{class:"result-bottom",ref:this.setBottomSpan,tabIndex:-1});t.length>this.limit?s.splice(this.lastSearchResultsTotal,0,a):s.push(a),e=i(o,null,i("div",{class:this.resultContainerClass,"data-test":"result-container"},s),this.renderResultsCount(),this.renderListFooter())}else e=this.showEmptyState?i(o,null,i("arcgis-hub-empty-state",null),i("div",{class:"no-results-action-container"},i("slot",{name:"no-results-action"}))):null;return i("div",{class:"gallery-list"},this.renderListHeader(),this.renderBulkActions(),i("span",{class:"result-top",ref:this.setResultTopSpan,tabIndex:-1}),e)}renderListHeader(){const t=this.renderResultsCount(),e=this.renderSort()||this.renderLayoutSwitcher()||this.renderGalleryActionsPopover();if(t||e)return i("div",{class:"gallery-list-header"},t&&i("div",{"aria-live":"polite",class:"results-count-container",role:"status"},this.renderResultsCount()),e&&i("div",{class:"list-header-controls-container"},this.renderSort(),this.renderLayoutSwitcher(),this.renderGalleryActionsPopover()))}get selectable(){return"none"!==this.selectionMode}get selectionCount(){return this._gallerySelection[this.query.targetEntity].length}get hasSelection(){return!!this.selectionCount}get _bulkActions(){var t;const e=t=>{(t=Object.assign({},t)).name&&(t.handler=this.handleBulkAction.bind(this,t));const{name:e,args:i}=t;return t.key=_(JSON.stringify({name:e,args:i})),t};return((null===(t=this.bulkActions)||void 0===t?void 0:t.actions)||[]).map((t=>((t=e(t)).children&&(t.children=t.children.map(e)),t)))}async handleBulkAction(t){const e=this._gallerySelection[this.query.targetEntity];if(t&&e.length){const{name:i,args:s}=t;this.arcgisHubGalleryBulkAction.emit({action:{name:i,args:s},selection:e})}}renderBulkActions(){if(this.hasSelection&&this._bulkActions.length)return i("calcite-action-pad",{class:{"bulk-actions":!0,sticky:"top"===this.bulkActions.position},"expand-disabled":!0,expanded:!0,layout:"horizontal",scale:"s"},i("div",{class:"selection-count"},this.intl.t("selected",{count:this.selectionCount})),this._bulkActions.map(this.renderBulkAction))}renderGalleryActionsPopover(){let t;return this._hasSlottedGalleryActions&&(t=i("div",{class:"actions-popover-container"},i("calcite-popover",{"auto-close":!0,label:this.intl.t("galleryActionsLabel"),overlayPositioning:"fixed",placement:"bottom-end",referenceElement:"gallery-actions-toggle"},i("div",{class:"actions-popover-content"},i("slot",{name:"gallery-actions"}))),i("calcite-button",{appearance:"transparent","icon-start":"ellipsis",id:"gallery-actions-toggle",kind:"neutral",onClick:this.logGalleryActionsTelemetry,round:!0,scale:"m"}))),t}logGalleryActionsTelemetry(){this.maybeSendTelemetry(Object.assign({},b.dictionary.category.interaction.action.search.label.action.details.overflow))}renderListFooter(){if(this.renderMoreResultsBtn()||this.renderBackToTopBtn())return i("div",{class:"gallery-list-footer"},i("div",null,this.renderMoreResultsBtn()),i("div",null,this.renderBackToTopBtn()))}renderResultsCount(){if(this.showResultsCount&&this.hasSearchResults)return i("h2",{class:"results-count"},this.intl.t("resultsCount",{pageTotal:this.searchResults.length,searchTotal:this.lastSearchResponse.total}))}renderGallery(){return i(o,null,this.renderSearch(),i("slot",{name:"collection-select"}),i("div",{class:"gallery-main"},this.renderFacets(),this.renderList(this.searchResults)),i("slot",{name:"click-actions"}))}renderLoadingScreen(){return i("div",{class:this.resultContainerClass,"data-test":"skeleton-loader-container"},this.renderSkeletons())}render(){return i(s,null,this.isInitialized?this.renderGallery():this.renderLoadingScreen())}static get assetsDirs(){return["locales"]}get element(){return a(this)}static get watchers(){return{context:["handleContextChange"],query:["fetchFacetsAndSearch"],layout:["prepareAndExecuteSearch"],term:["prepareAndExecuteSearch"],limit:["prepareAndExecuteSearch"],state:["onStateChanged"],gallerySelection:["onGallerySelectionChanged"]}}};bt([k({timeout:100})],vt.prototype,"prepareAndExecuteSearch",null),bt([C("bulkActions")],vt.prototype,"_bulkActions",null),vt.style=':host{display:flex;flex-direction:column;gap:1.25rem;--columns:4;--hub-gallery-input-background:#fff;--hub-gallery-input-text:#151515;--hub-gallery-font-size-large:var(--calcite-font-size-1);--hub-gallery-bulk-actions-bottom:4rem}h1,h2,h3,h4,h5,h6{font-family:var(--hub-heading-family, inherit)}arcgis-hub-facet-list{flex:0 0 25%;max-width:25%}.gallery-main{display:flex;flex-direction:row;align-items:flex-start;column-gap:2.5rem}.gallery-list{display:flex;width:100%;flex-direction:column;gap:1.25rem}.gallery-list-footer{display:flex;justify-content:space-between}.gallery-list-header{display:grid;grid-template-areas:\'resultsCount sortAndLayout\';grid-template-columns:1fr 1fr}.results-count-container{grid-area:resultsCount}.list-header-controls-container{display:flex;align-items:center;justify-content:flex-end;gap:0.5rem;grid-area:sortAndLayout}.bulk-actions{position:fixed;z-index:10}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -10px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}.bulk-actions{animation:in-down 300ms ease-in-out forwards;align-self:center;--tw-shadow:0 6px 20px -4px rgba(0, 0, 0, 0.1), 0 4px 12px -2px rgba(0, 0, 0, 0.08);--tw-shadow-colored:0 6px 20px -4px var(--tw-shadow-color), 0 4px 12px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);bottom:var(--hub-gallery-bulk-actions-bottom)}.bulk-actions.sticky{position:sticky;top:1rem;bottom:auto}.bulk-actions .selection-count{display:flex;align-self:center;padding-left:1rem;padding-right:1rem;font-weight:var(--calcite-font-weight-medium);color:var(--calcite-ui-text-1)}.bulk-actions calcite-dropdown-item>div{display:flex;flex-direction:column;gap:0.25rem}.bulk-actions calcite-dropdown-item>div div:first-child{font-weight:var(--calcite-font-weight-medium)}.layout-option{height:100%}.actions-popover-container{margin-inline-start:1rem}.actions-popover-content{padding:0.5rem}.gallery-list>.results-count{margin-top:1.25rem}.no-results-action-container{display:grid;justify-content:center}.search-bar{margin-bottom:0px}.search-sort{margin-bottom:0px}.results-count{display:flex;align-items:center;font-size:var(--calcite-font-size-1);line-height:1.5rem;font-weight:var(--calcite-font-weight-normal)}:host([layout="list"]) .card-container,:host([layout="grid"]) .card-container,:host([layout="grid-filled"]) .card-container{display:grid;gap:1.5rem}:host([layout="grid"]) .card-container{grid-template-columns:repeat(auto-fill, minmax(max(240px, (100% - (4 - 1) * 24px) / 4), 1fr))}:host([layout="grid-filled"]) .card-container{grid-template-columns:repeat(12, 1fr)}:host([layout="grid-filled"]) .card-container>*{grid-column:span calc(12 / var(--columns))}:host([layout="grid-filled"]) .card-container.cols-4>*:nth-of-type(4n+1):last-of-type,:host([layout="grid-filled"]) .card-container.cols-3>*:nth-of-type(3n+1):last-of-type,:host([layout="grid-filled"]) .card-container.cols-2>*:nth-of-type(2n+1):last-of-type{grid-column:span 12 / span 12}:host([layout="grid-filled"]) .card-container.cols-4>*:nth-of-type(4n+1):nth-last-of-type(2),:host([layout="grid-filled"]) .card-container.cols-4>*:nth-of-type(4n+2):last-of-type,:host([layout="grid-filled"]) .card-container.cols-3>*:nth-of-type(3n+1):nth-last-of-type(2),:host([layout="grid-filled"]) .card-container.cols-3>*:nth-of-type(3n+2):last-of-type{grid-column:span 6 / span 6}:host([layout="grid-filled"]) .card-container.cols-4>*:nth-of-type(4n+1):nth-last-of-type(3),:host([layout="grid-filled"]) .card-container.cols-4>*:nth-of-type(4n+2):nth-last-of-type(2),:host([layout="grid-filled"]) .card-container.cols-4>*:nth-of-type(4n+3):last-of-type{grid-column:span 4 / span 4}[slot="header"]{font-size:var(--calcite-font-size-1);line-height:1.5rem;font-weight:var(--calcite-font-weight-normal)}.loading-link-button{position:relative}.loading-link-button:after{content:\'\';position:absolute;top:0;right:0;bottom:0;left:0}@keyframes shimmer{0%{background-size:200% 100%;background-position:100% 0}100%{background-size:200% 100%;background-position:-100% 0}}.loading-link-button:after{animation:shimmer 2s cubic-bezier(0.4, 0, 0.2, 0.8) infinite;background-image:linear-gradient(90deg, rgba(255, 255, 255, 0) 0, rgba(255, 255, 255, 0) 40%, rgba(255, 255, 255, 0.6) 50%, rgba(255, 255, 255, 0) 60%, rgba(255, 255, 255, 0) 100%);background-color:var(--calcite-ui-foreground-3)}.loading-link-button{margin-top:1rem;height:2rem}.result-top{position:absolute}.layout-switcher-container{display:flex;align-items:center}.result-bottom{position:absolute}';const yt=class{constructor(i){t(this,i),this.arcgisHubLayoutButtonSelect=e(this,"arcgisHubLayoutButtonSelect",7),this.selected=void 0,this.icon=void 0,this.layout=void 0,this.tooltip=void 0,p(this,"selectLayout","setPopoverElement","maybeOpenPopover","maybeClosePopover")}get _kind(){return this.selected?"neutral":"brand"}get appearance(){return this.selected?"solid":"transparent"}setPopoverElement(t){this.popoverElement=t}maybeOpenPopover(){this.tooltip&&(this.popoverElement.open=!0)}maybeClosePopover(){this.tooltip&&(this.popoverElement.open=!1)}selectLayout(){this.arcgisHubLayoutButtonSelect.emit(this.layout)}render(){return i(s,{onMouseEnter:this.maybeOpenPopover,onMouseLeave:this.maybeClosePopover},i("calcite-button",{appearance:this.appearance,"aria-current":this.selected,id:"toggle-button",kind:this._kind,label:this.tooltip||this.layout,onClick:this.selectLayout,scale:"l"},i("calcite-icon",{icon:this.icon})),this.tooltip&&i("calcite-popover",{label:this.tooltip,placement:"bottom-end",ref:this.setPopoverElement,referenceElement:"toggle-button"},i("div",{class:"popover-content"},this.tooltip)))}};yt.style='.popover-content{margin:0.75rem}#toggle-button{height:100%}#toggle-button[kind="neutral"]{--calcite-ui-icon-color:#151515}#toggle-button[kind="neutral"]:hover,#toggle-button[kind="neutral"]:focus{--calcite-ui-icon-color:var(--calcite-ui-brand)}calcite-icon{position:relative;top:.10rem}';const wt=class{constructor(i){t(this,i),this.arcgisHubMapViewReady=e(this,"arcgisHubMapViewReady",7),this.center="0,0",this.zoom=2,this.extent=void 0,this.expand=void 0,this.basemap="topo-vector",this.graphics=void 0,this.disablePinchZoomAndPanning=!1,this.disableDoubleClickZoom=!1,this.disableMouseWheelZoom=!1,p(this,"_setContainer")}handleBasemapChanged(t){this.map.basemap=M.fromId(t)}handleCenterChanged(t){this.center=t;const[e,i]=this.centerToCoords(t);this.view.center=T.fromJSON({longitude:e,latitude:i})}handleGraphicsChanged(t){this.isMapLoaded()&&(this.view.graphics.removeAll(),t&&this.view.graphics.addMany(this.buildGraphics()))}handleExtentChanged(){this.isMapLoaded()&&this.setExtent()}handleDisablePinchZoomAndPanningChange(){this.disablePinchZoomAndPanning?this.dragHandle=this.view.on("drag",this.stopEvtPropagation):(this.dragHandle.remove(),this.dragHandle=null)}handleDisableDoubleClickZoomChange(){this.disableDoubleClickZoom?this.doubleClickHandle=this.view.on("double-click",this.stopEvtPropagation):(this.doubleClickHandle.remove(),this.doubleClickHandle=null)}handleDisableMouseWheelZoomChange(){this.disableMouseWheelZoom?this.mouseWheelHandle=this.view.on("mouse-wheel",this.stopEvtPropagation):(this.mouseWheelHandle.remove(),this.mouseWheelHandle=null)}isMapLoaded(){return!!this.map}centerToCoords(t){return t.split(",").map((t=>+t))}createGraphic(t){const e=t;let i=e.clone?e.clone():new R(e);var s,a;return a=i,((s=e).symbol&&!a.symbol||s.geometry&&!a.geometry)&&(i=R.fromJSON(e)),i}buildGraphics(){try{return this.graphics.filter(Boolean).map((t=>this.createGraphic(t)))}catch(t){return[]}}setExtent(){let t=new D(this.extent);this.expand&&(t=t.expand(this.expand)),this.view.extent=t}_setContainer(t){this._container=t}async componentDidLoad(){E(),this.map=new F({basemap:M.fromId(this.basemap)}),this.view=new z({map:this.map,container:this._container,center:this.centerToCoords(this.center),zoom:this.zoom}),this.disablePinchZoomAndPanning&&(this.dragHandle=this.view.on("drag",this.stopEvtPropagation)),this.disableDoubleClickZoom&&(this.doubleClickHandle=this.view.on("double-click",this.stopEvtPropagation)),this.disableMouseWheelZoom&&(this.mouseWheelHandle=this.view.on("mouse-wheel",this.stopEvtPropagation)),this.extent&&this.setExtent(),this.view.graphics.addMany(this.buildGraphics()),this.arcgisHubMapViewReady.emit({view:this.view})}stopEvtPropagation(t){t.stopPropagation()}render(){return i(s,null,i("div",{ref:this._setContainer}))}static get watchers(){return{basemap:["handleBasemapChanged"],center:["handleCenterChanged"],graphics:["handleGraphicsChanged"],extent:["handleExtentChanged"],expand:["handleExtentChanged"],disablePinchZoomAndPanning:["handleDisablePinchZoomAndPanningChange"],disableDoubleClickZoom:["handleDisableDoubleClickZoomChange"],disableMouseWheelZoom:["handleDisableMouseWheelZoomChange"]}}};wt.style=".sc-arcgis-hub-map-h{display:block}.esri-view.sc-arcgis-hub-map{height:inherit;width:inherit}";const xt=class{constructor(i){t(this,i),this.arcgisMapFacetChange=e(this,"arcgisMapFacetChange",7),this.facet=void 0,this.resultsCount=void 0,this.view=void 0,this.shouldFilterByExtent=!1,p(this,"toggleFilterOnExtent")}async componentWillLoad(){const t=document.createElement("link");t.href="https://js.arcgis.com/4.26/esri/themes/light/main.css",t.rel="stylesheet",this.element.shadowRoot.appendChild(t),this.intl=await m.loadIntlForComponent(this.element)}handleMapViewReady(t){t.stopPropagation();const e=t.detail.view;e.when((()=>{e.ui.components=[];const t=new A({view:e,popupEnabled:!1});e.ui.add(t,{position:"top-leading"}),this.view=e,this.initializeMap()})),I((()=>e.extent),(()=>this.shouldFilterByExtent&&this.handleExtentChange()))}handleFacetChange(t,e){h(t.value||[])!==h(e.value||[])&&this.initializeMap()}async initializeMap(){this.shouldFilterByExtent=!!this.facet.value,this.view&&this._initialExtent&&(await this.maybeLoadProjectionEngine(),this.view.extent=this._initialExtent)}get _initialExtent(){let t=null;const{value:e,extent:i}=this.facet;return e?t=new B(d(e)):i&&(t=new B(i)),t}async maybeLoadProjectionEngine(){const{spatialReference:t}=this._initialExtent;if(!t.isWGS84&&!t.isWebMercator)return H.isLoaded()||H.load()}handleExtentChange(){this.arcgisMapFacetChange.emit({key:this.facet.key,value:this.bbox})}get bbox(){let t=null;if(this.shouldFilterByExtent&&this.view.extent){const e=$(this.view.extent);t=u(e)}return t}get shouldShowResultCount(){return!isNaN(this.resultsCount)}toggleFilterOnExtent(t){this.shouldFilterByExtent=t.detail,this.handleExtentChange()}render(){return i(s,{"data-element":"map-facet"},i("arcgis-hub-map",{basemap:"gray-vector",expand:1.5},this.shouldShowResultCount&&i("arcgis-hub-map-widget-container",{"expand-disabled":!0,expanded:!0,scale:"m",view:this.view,"view-position":"top-leading"},i("div",{class:"result-count"}," ",this.intl.t("resultsCount",{resultsCount:this.resultsCount})," ")),i("arcgis-hub-map-widget-container",{"expand-disabled":!0,expanded:!0,scale:"m",view:this.view,"view-position":"bottom-leading"},i("arcgis-hub-map-widget-checkbox",{checked:this.shouldFilterByExtent,onArcgisHubCheckboxWidgetClicked:this.toggleFilterOnExtent,scale:"m",text:this.intl.t("checkboxLabel")})),i("arcgis-hub-map-widget-container",{"expand-disabled":!0,scale:"s",view:this.view,"view-position":"bottom-trailing"},i("arcgis-hub-map-widget-zoom",{scale:"s",view:this.view}))))}static get assetsDirs(){return["locales"]}get element(){return a(this)}static get watchers(){return{facet:["handleFacetChange"]}}};(function(t,e,i,s){var a,o=arguments.length,n=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,s);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(n=(o<3?a(n):o>3?a(e,i,n):a(e,i))||n);o>3&&n&&Object.defineProperty(e,i,n)})([k({timeout:500})],xt.prototype,"handleExtentChange",null),xt.style=":host{display:block}arcgis-hub-map{height:18.5rem;width:100%}arcgis-hub-map .esri-ui-top-left{margin-top:-.375rem;margin-left:-.375rem}arcgis-hub-map .esri-ui-bottom-left{margin-left:-.375rem}.result-count{font-weight:var(--calcite-font-weight-medium);padding:.375rem}";const Ct=class{constructor(i){t(this,i),this.arcgisHubCheckboxWidgetClicked=e(this,"arcgisHubCheckboxWidgetClicked",7),this.scale="m",this.text=void 0,this.checked=!1,p(this,"handleCheckboxChange")}get parentContainer(){const{el:t}=this;return t&&t.closest("arcgis-hub-map-widget-container")}handleCheckboxChange(t){this.checked=t.target.checked,this.arcgisHubCheckboxWidgetClicked.emit(this.checked)}render(){return this.parentContainer&&i("calcite-label",{class:"checkbox-label",layout:"inline",scale:this.scale},i("calcite-checkbox",{checked:this.checked,onCalciteCheckboxChange:this.handleCheckboxChange,scale:this.scale}),this.text)}get el(){return a(this)}};Ct.style=":host{display:block;padding:.5rem;cursor:pointer}.checkbox-label{--calcite-label-margin-bottom:0}";const kt=class{constructor(e){t(this,e),this.expandDisabled=void 0,this.viewPosition="top-right",this.view=void 0,this.scale="m",this.expanded=void 0,p(this,"toggleExpanded")}get position(){return this.viewPosition.includes("right")?"end":"start"}componentWillLoad(){const{view:t,el:e,viewPosition:i}=this;t&&t.ui&&t.ui.add(e,i)}disconnectedCallback(){const{view:t,el:e}=this;t&&t.ui&&t.ui.remove(e)}addWidgetToView(t,e){t&&t.ui&&t!==e&&this.view.ui.add(this.el,this.viewPosition)}toggleExpanded(){this.expanded=!this.expanded}render(){const{expandDisabled:t,expanded:e,position:a,scale:o}=this;return i(s,null,this.view&&i("calcite-action-pad",{expandDisabled:t,expanded:e,onCalciteActionPadToggle:this.toggleExpanded,position:a,scale:o},i("slot",null)))}get el(){return a(this)}static get watchers(){return{view:["addWidgetToView"]}}};kt.style=":host{display:flex;justify-content:flex-end;--tw-shadow:0 6px 20px -4px rgba(0, 0, 0, 0.1), 0 4px 12px -2px rgba(0, 0, 0, 0.08);--tw-shadow-colored:0 6px 20px -4px var(--tw-shadow-color), 0 4px 12px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}:host-context(div.esri-ui-inner-container.esri-ui-corner-container){box-shadow:none !important}";const jt=class{constructor(i){t(this,i),this.hubTelemetry=e(this,"hubTelemetry",7),this.handles=[],this.view=void 0,this.scale="m",this.canZoomIn=void 0,this.canZoomOut=void 0,p(this,"zoomIn","zoomOut","updateCanZoomIn","updateCanZoomOut")}async componentWillLoad(){const{el:t}=this;this.intl=await m.loadIntlForComponent(t),await this.connectViewModel(),this.connectWatch(),E()}connectedCallback(){this.connectWatch()}disconnectedCallback(){this.removeWatch()}handleViewChange(t,e){t&&t!==e&&(this.removeWatch(),this.connectViewModel().then((()=>{this.connectWatch()})))}connectWatch(){const{view:t,handles:e,zoomViewModel:i}=this;t&&i&&e.push(P(i,"canZoomIn",this.updateCanZoomIn),P(i,"canZoomOut",this.updateCanZoomOut))}removeWatch(){const{handles:t}=this;t.forEach((t=>{t.remove()})),this.handles=[]}async connectViewModel(){const{view:t,zoomViewModel:e}=this;if(t&&!e){await t.when(),this.zoomViewModel=new Z({view:t});const{canZoomIn:e,canZoomOut:i}=this.zoomViewModel;this.canZoomIn=e,this.canZoomOut=i}}updateCanZoomIn(t){this.canZoomIn=t}updateCanZoomOut(t){this.canZoomOut=t}zoomIn(){const{zoomViewModel:t,canZoomIn:e,view:i}=this;t&&e&&(t.zoomIn(),this.hubTelemetry.emit(Object.assign(Object.assign({},b.dictionary.category.interaction.action.zoom.label.in),{details:i.zoom})))}zoomOut(){const{zoomViewModel:t,canZoomOut:e,view:i}=this;t&&e&&(this.zoomViewModel.zoomOut(),this.hubTelemetry.emit(Object.assign(Object.assign({},b.dictionary.category.interaction.action.zoom.label.out),{details:i.zoom})))}render(){const{zoomIn:t,zoomOut:e,canZoomIn:a,canZoomOut:o,scale:n}=this,r=this.intl.t("zoomIn"),c=this.intl.t("zoomOut");return i(s,{"data-element":"map-widget-zoom"},i("arcgis-hub-map-widget-generic",{disabled:!a,icon:"plus",onClick:t,scale:n,text:r}),i("arcgis-hub-map-widget-generic",{disabled:!o,icon:"minus",onClick:e,scale:n,text:c}))}static get assetsDirs(){return["locales"]}get el(){return a(this)}static get watchers(){return{view:["handleViewChange"]}}};jt.style="";const Ot=class{constructor(i){t(this,i),this.inputChange=e(this,"hubSearchInputChange",7),this.value=void 0,this.placeholder="Enter search term...",this.text="Search",this.scale=void 0,p(this,"handleInput","handleInputChange")}handleInputChange(){this.inputChange.emit(this.value)}handleInput(t){this.value=t.target.value}render(){return i(s,null,i("calcite-input",{clearable:!0,onCalciteInputChange:this.handleInputChange,onCalciteInputInput:this.handleInput,placeholder:this.placeholder,scale:this.scale,value:this.value},i("calcite-button",{scale:this.scale,slot:"action"},this.text)))}};Ot.style=":host{margin-bottom:1.5rem;display:block}calcite-input{--calcite-ui-foreground-1:var(--hub-gallery-input-background);--calcite-ui-text-1:var(--hub-gallery-input-text)}";const St=class{constructor(i){t(this,i),this.hubSearchSortChange=e(this,"hubSearchSortChange",7),this.sortOptions=[],this.activeSortOption=void 0,this.sortOrderIcon=void 0,p(this,"setDropdownEl","handleOrderChange")}async componentWillLoad(){this.intl=await m.loadIntlForComponent(this.element)}componentWillRender(){this.sortOrderIcon="asc"===this.activeSortOption.order?"sort-ascending-arrow":"sort-descending-arrow"}handleFieldChangeEvent(){const t=this.dropdownEl.selectedItems;if(t.length){const e=t[0].dataset.value||null;this.activeSortOption=this.sortOptions.find((t=>t.attribute===e)),this.activeSortOption.order=f[this.activeSortOption.defaultOrder],this.hubSearchSortChange.emit(this.activeSortOption)}}setDropdownEl(t){this.dropdownEl=t}handleOrderChange(){this.activeSortOption.order="asc"===this.activeSortOption.order?"desc":"asc",this.sortOrderIcon="asc"===this.activeSortOption.order?"sort-ascending-arrow":"sort-descending-arrow",this.hubSearchSortChange.emit(this.activeSortOption)}render(){var t,e;return i(s,null,i("calcite-dropdown",{ref:this.setDropdownEl},i("calcite-button",{appearance:"transparent","aria-label":this.intl.t("change-sort-order"),color:"blue","data-test":"sort-attribute","icon-end":"caret-down",slot:"trigger"},i("span",{title:this.intl.t(null!==(t=this.activeSortOption.attribute)&&void 0!==t?t:"relevance")},this.intl.t(null!==(e=this.activeSortOption.attribute)&&void 0!==e?e:"relevance"))),i("calcite-dropdown-group",{"selection-mode":"single"},this.sortOptions.map((t=>{var e,s,a;return i("calcite-dropdown-item",{"aria-label":this.intl.t("sort-by")+this.intl.t(null!==(e=t.attribute)&&void 0!==e?e:"relevance"),"data-value":t.attribute,key:t.attribute,selected:this.activeSortOption.attribute===t.attribute,title:this.intl.t(null!==(s=t.attribute)&&void 0!==s?s:"relevance")},this.intl.t(null!==(a=t.attribute)&&void 0!==a?a:"relevance"))})))),this.activeSortOption.order&&i("calcite-button",{appearance:"transparent",class:"sort-order",color:"blue","data-test":"sort-direction","icon-end":this.sortOrderIcon,onClick:this.handleOrderChange,title:this.intl.t(this.activeSortOption.order)}))}static get assetsDirs(){return["locales"]}get element(){return a(this)}};St.style=":host{margin-bottom:1.25rem;display:flex;flex-direction:row;justify-content:flex-end;--calcite-font-size--1:var(--hub-gallery-font-size-large)}.sort-order{--calcite-font-size-0:var(--hub-gallery-font-size-large)}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";const Lt=class{constructor(i){t(this,i),this.arcgisHubTreeFacetChange=e(this,"arcgisHubTreeFacetChange",7),this.arcgisHubFacetMoreLessClicked=e(this,"arcgisHubFacetMoreLessClicked",7),this.topLevelPageSize=5,this.facet=void 0,this.showLimitedOptions=!0,p(this,"toggleMoreOrLessButton","setPageSeparator","handleTreeSelect")}handleTreeSelect(t){t.stopPropagation();const e=t.target.selectedItems.map((t=>t.dataset.key)),i=((t,e)=>{const i=t.filter((t=>!e.includes(t))),s=e.filter((e=>!t.includes(e)));let a=null;return i.length?a={operation:"removed",keys:i}:s.length&&(a={operation:"added",keys:s}),a})(this.facet.options.filter((t=>t.selected&&!t._unrecognized)).map((t=>t.key)),e),s=this.facet.options.find((t=>i.keys.includes(t.key)));this.arcgisHubTreeFacetChange.emit({key:this.facet.key,optionKeys:i.keys,selected:"added"===i.operation,topLevelIndex:s._telemetryIndex})}async componentWillLoad(){this.intl=await m.loadIntlForComponent(this.element)}get optionsAsTree(){const t=this.facet.options.filter((t=>!t._unrecognized));return at(t)}get numTopLevelOptions(){return ct(this.optionsAsTree).length}get optionsLeftToDisplay(){return this.numTopLevelOptions-this.topLevelPageSize}get moreOrLessButtonIconEnd(){return this.showLimitedOptions?"chevron-down":"chevron-up"}get moreOrLessButtonLabel(){return this.showLimitedOptions?this.intl.t("showMore",{num:this.optionsLeftToDisplay}):this.intl.t("showLess")}setPageSeparator(t){this.pageSeparator=t}toggleMoreOrLessButton(){this.arcgisHubFacetMoreLessClicked.emit({facet:this.facet,isMore:this.showLimitedOptions}),this.showLimitedOptions=!this.showLimitedOptions,this.pageSeparator.focus()}renderTopLevelOptions(){const t=ct(this.optionsAsTree).map(((t,e)=>ht(t,e))),e=t.slice(0,this.topLevelPageSize),s=this.showLimitedOptions?[]:t.slice(this.topLevelPageSize);return[...e,i("span",{key:"page-separator",ref:this.setPageSeparator,tabIndex:-1}),...s]}renderMoreLessButton(){if(this.numTopLevelOptions>this.topLevelPageSize)return i("div",{class:"more-or-less-container"},i("calcite-button",{appearance:"transparent",color:"blue","icon-end":this.moreOrLessButtonIconEnd,onClick:this.toggleMoreOrLessButton},this.moreOrLessButtonLabel))}render(){return i(s,{"data-element":"tree-facet"},i("div",null,i("calcite-tree",{onCalciteTreeSelect:this.handleTreeSelect,"selection-mode":"ancestors"},this.renderTopLevelOptions()),this.renderMoreLessButton()))}static get assetsDirs(){return["locales"]}get element(){return a(this)}};Lt.style=":host{display:block}calcite-tree-item{--calcite-font-size--1:16px;--calcite-ui-text-3:var(--calcite-ui-text-1);padding-top:0.5rem}.option-label{overflow-wrap:anywhere;-webkit-hyphens:auto;hyphens:auto}.more-or-less-container{width:100%;display:flex;flex-direction:row-reverse;margin-top:0.5rem}";export{it as arcgis_hub_date_range_facet,st as arcgis_hub_empty_state,gt as arcgis_hub_facet_list,mt as arcgis_hub_facet_options,vt as arcgis_hub_gallery,yt as arcgis_hub_layout_button,wt as arcgis_hub_map,xt as arcgis_hub_map_facet,Ct as arcgis_hub_map_widget_checkbox,kt as arcgis_hub_map_widget_container,jt as arcgis_hub_map_widget_zoom,Ot as arcgis_hub_search_input,St as arcgis_hub_search_sort,Lt as arcgis_hub_tree_facet}