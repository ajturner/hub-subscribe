import{r as t,h as s,F as i,H as o}from"./p-d4ba4c14.js";import{C as a}from"./p-3b563ebe.js";import{A as e}from"./p-c29c8d33.js";const r=class{constructor(s){t(this,s),this.data=void 0,this.reportTitle=void 0,this.titleTooltip=void 0,this.subtitle=void 0,this.options={},this.isLoading=void 0,this.headers=void 0,this.rows=void 0,this.isTransforming=!0}handleChange(){this.isLoading||this.transform(this.data,this.options).then((({headers:t,rows:s})=>{this.headers=t,this.rows=s})).finally((()=>{this.isTransforming=!1}))}async transform(t,i){const o=[],r=[],{seriesTransforms:n={},dataTransforms:h}=i,l=t.map((async t=>{const i=[],l=await Object.entries(t).map((async([t,l])=>{var d,c,v,u,m;const w={};let b=!1;if(void 0!==l){const f=t;if(Object.values(a).includes(t)&&(t=t.split(":")[1],b=!0),!r.includes(t)){const s={id:t,i18n:(null===(d=n[t])||void 0===d?void 0:d.title)||(null===(c=null==h?void 0:h.find((t=>t.name===f)))||void 0===c?void 0:c.title)||this.capitalize(t)};b&&(s.alignment=e.end),r.push(t),b?o.push(s):o.unshift(s)}if(w[t]=l,!b&&i.push(l),null===(v=n[t])||void 0===v?void 0:v.value){const{display:i,link:o}=n[t].value,a=i?await i(l):l;w[t]=o?s("a",{href:o.href?await o.href(l):l,target:o.target},a):a}else{const s=(null===(m=null===(u=null==h?void 0:h.find((t=>t.name===f)))||void 0===u?void 0:u.value)||void 0===m?void 0:m.display)||(t=>t);w[t]=s(l)}}return w}));return this.resolveRow(l,i.join("|"))})),d=await Promise.all(l).then((t=>t));return{headers:o,rows:d}}async resolveRow(t,s){const i=await Promise.all(t);return i.push({key:s}),i.reduce(((t,s)=>Object.assign(t,s)),{})}capitalize(t){return t[0].toUpperCase()+t.slice(1).toLowerCase()}render(){return s(o,null,this.isLoading||this.isTransforming?s("arcgis-skeleton-loader",{active:!0,rows:4,showFooter:!0}):s(i,null,s("arcgis-hub-table",{headers:this.headers,rows:this.rows,subtitle:this.subtitle,"table-title":this.reportTitle})))}static get watchers(){return{data:["handleChange"],options:["handleChange"]}}};export{r as arcgis_telemetry_tabular}