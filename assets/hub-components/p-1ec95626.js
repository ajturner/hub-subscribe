import{c as t}from"./p-c94c130f.js";import{f as e}from"./p-57f04fe1.js";import{e as r}from"./p-56b73d71.js";import{b as s,c as l}from"./p-8e7f4c22.js";function a(){return function(t,e,r){const{value:s}=r,l=`_${e}Called`;Object.defineProperty(t,l,{writable:!0,value:!1});const a=`_${e}Cache`;return Object.defineProperty(t,a,{writable:!0}),Object.assign(Object.assign({},r),{value:function(...t){return this[l]||(this[l]=!0,this[a]=s.apply(this,t)),this[a]}})}}var o;!function(t){t.Item="item",t.EditPost="edit.post",t.EditPostGroup="edit.post.group",t.EditPostItem="edit.post.item",t.EditReply="reply.post",t.EditReplyGroup="edit.reply.group",t.EditReplyItem="edit.reply.item",t.Group="group",t.Reply="reply"}(o||(o={}));const n={[o.Item]:{title:"item.title",message:"item.message"},[o.EditPost]:{title:"post.title",message:"post.message"},[o.EditPostGroup]:{title:"post.title",message:"post.message.group"},[o.EditPostItem]:{title:"post.title",message:"post.message.item"},[o.EditReply]:{title:"reply.title",message:"reply.message"},[o.EditReplyGroup]:{title:"reply.title",message:"reply.message.group"},[o.EditReplyItem]:{title:"reply.title",message:"reply.message.item"},[o.Group]:{title:"group.title",message:"group.message"},[o.Reply]:{title:"reply.title.generic",message:"reply.message.generic"}},p=t(((t,s)=>e(Object.assign({postId:t,data:{relations:[r.REACTIONS,r.REPLIES]}},s)).then((t=>(t.replyCount=t.replies.total,delete t.replies,t)))),{scope:"channels",getKey:t=>t,ttl:3e3});async function i(t,e){let r,{postId:s,post:l}=t;if(l)s=l.id,r=null;else if(s)try{l=await p(s,e),r=null}catch(t){r=t,l=null}else s=null,l=null,r=null;return{postId:s,post:l,postError:r}}const u=t(((t,e)=>s(Object.assign({username:t},e))),{scope:"users"}),c=t(((t,e)=>l(t,e)),{scope:"orgs"});async function g(t,e){const{post:r}=t;let{postCreator:s,postCreatorId:l,postCreatorOrg:a}=t,o=null,n=null;if(r){l=r.creator;try{s=await u(r.creator,e),o=null}catch(t){o=t,s=null}try{a=await c(s.orgId,e),n=null}catch(t){n=t,a=null}}else l=null,a=null,o=null,s=null,n=null;return{postCreator:s,postCreatorError:o,postCreatorId:l,postCreatorOrg:a,postCreatorOrgError:n}}async function m(t,e){const{post:r}=t;let{parent:s,parentId:l}=t,a=null;const o=async t=>{try{({post:s,postId:l,postError:a}=await i({postId:t},e))}catch(e){l=t,s=null,a=e}return{parentError:a,parentId:l,parent:s}};return r?r.parentId?null!==s&&r.parentId!==(null==s?void 0:s.id)&&({parent:s,parentId:l,parentError:a}=await o(r.parentId)):(s=null,l=r.parentId,a=null):s?(l=s.id,a=null):l?({parent:s,parentId:l,parentError:a}=await o(l)):(s=null,a=null,l=null),{parent:s,parentError:a,parentId:l}}async function d(t,e){let{parent:r,parentCreatorId:s,parentCreator:l,parentCreatorOrg:a}=t,o=null,n=null;return r?({postCreator:l,postCreatorError:o,postCreatorId:s,postCreatorOrg:a,postCreatorOrgError:n}=await g({post:r,postCreator:l,postCreatorOrg:a},e)):(r=null,l=null,o=null,s=null,a=null,n=null),{parentCreatorId:s,parentCreator:l,parentCreatorError:o,parentCreatorOrg:a,parentCreatorOrgError:n}}export{o as A,g as a,m as b,a as c,d,n as e,i as f,u as g,c as h}