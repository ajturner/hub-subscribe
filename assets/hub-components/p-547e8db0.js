var n=function(n,t,r){return void 0===r&&(r=void 0),t.split(".").reduce((function(n,t){return n?n[t]:r}),n)};function t(n,t){return Object.keys(n).reduce((function(r,e){return r[e]=t(n[e],e,n),r}),{})}function r(n,e,o){return o=o||"",Array.isArray(n)?n.map(i):!n||"object"!=typeof n||n instanceof Date||function(n){return n instanceof RegExp}(n)||function(n){return"function"==typeof n}(n)?e(n,o):Object.assign({},n,t(n,i));function i(n,t){return r(n,e,o?o+"."+t:t)}}function e(n){return Array.isArray(n)?(l=n.map(p).filter((function(n){return null!=n})),v=l,(s=l.reduce((function(n,t){if(u(t)&&i(t)){var r=o(t);r>n&&(n=r)}return n}),-1))>-1&&(v=0===s?[]:"{{delete:"+(s-1)+"}}"),v):n&&"object"==typeof n?(a=t(n,p),(c=Object.keys(a).reduce((function(n,t){var r=a[t];if(u(r)&&i(r)){var e=o(r);e>n.maxLevel&&(n.maxLevel=e)}else n.obj[t]=r;return n}),{obj:{},maxLevel:-1})).maxLevel>0?1===c.maxLevel?void 0:"{{delete:"+(c.maxLevel-1)+"}}":c.obj):(f=r=n,"string"==typeof r&&i(r)&&(f=function(n){var t=o(n);return 0===t?void 0:"{{delete:"+t+"}}"}(r)),f);var r,f,a,c,l,v,s;function p(n){return e(n)}}var o=function(n){return parseInt(n.replace(/{|}/g,"").split(":")[1])};function i(n){return!(!n||"string"!=typeof n)&&n.indexOf("{{delete")>-1}var u=function(n){return"string"==typeof n};function f(n,t,r,e){void 0===e&&(e=0);var o=t;return t||(o="{{delete:"+e+"}}"),o}var a=function(n){var t={};if(Array.isArray(n))t=n.map(a);else if("object"==typeof n)for(var r in n)t[r]=null!=n[r]&&"object"==typeof n[r]?a(n[r]):n[r];else t=n;return t},c=/{{\s*?[\w].*?}}/g;function l(n){return n||""===n||0===n}function v(t,o,i){if(void 0===i&&(i=null),(i=a(i)||{}).optional)throw new Error("Please do not pass in an `optional` transform; adlib provides that internally.");return i.optional=f,e(r(t,(function(t){if("string"!=typeof t)return t;var r,e=t.match(c);return e&&e.length?(e.map((function(t){var r=!1,e=t.replace(/{|}/g,"").trim();if(e.indexOf("||")>-1){var u=e.split("||").map((function(n){return n.trim()})),f=u.length;e=u.find((function(t,e){var i,u;return i=o,u=t.split(":")[0],null!=n(i,u,null)?t:e+1===f&&(r=!0,isNaN(t)||(t=parseInt(t)),t)}))}var a={key:t,value:e};if(!r){var c=function(t,r,e){var o,i=t.split(":");if(i.length>1){var u,f=i[0],a=i[1];if(i[2]&&(u=i[2]),!e||!e[a]||"function"!=typeof e[a])throw new Error("Attempted to apply non-existant transform "+a+" on "+f+" with params "+t);o=n(r,f),o=e[a](f,o,r,u)}else o=n(r,t);return o}(e,o,i);a.value=l(c)?c:t}return a})).forEach((function(n){t===n.key?("string"==typeof n.value&&(isNaN(n.value)||""===n.value||(n.value.indexOf(".")>-1?n.value=parseFloat(n.value):"0"!==n.value[0]&&(n.value=parseInt(n.value)))),r=n.value):t=t.replace(n.key,n.value)})),l(r)?r:t):t})))}function s(n,t){return v(t,{},{translate:t=>n.t(t)})}export{s as i}