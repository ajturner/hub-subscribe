import{r as t,c as i,h as e,F as s,H as n,a}from"./p-d4ba4c14.js";import{b as c}from"./p-fd260f2d.js";import{i as h}from"./p-be5c5009.js";import{c as l}from"./p-b728aff4.js";import"./p-796574a4.js";const r=class{constructor(e){t(this,e),this.hubUserPrivacySettingsChanged=i(this,"hubUserPrivacySettingsChanged",7),this.config={},this.userSettings={accepted:!1,performance:!1,targeting:!1,functional:!1,id:"",timestamp:0},this.esriTrackingEnabled=!1,this.thirdPartyTrackingEnabled=!1,this._userSettings=void 0,this.shouldShowModal=!1,this.shouldShowNonmodal=!1,this.shouldShowNotice=!0,c(this,"handleAcceptAllClick","handleAcceptNecessaryClick","handleConfirmClick","handleManagePrivacyClick","handleModalClose","handleNonmodalClose","handleSettingsChange","handleViewSettingsClick")}get shouldRender(){var t;return!!(null===(t=this.config)||void 0===t?void 0:t.allowPrivacyConfig)}async componentWillLoad(){var t,i;this._userSettings=l(this.userSettings),this.intl=await h.loadIntlForComponent(this.element),this.shouldShowNonmodal=!this._userSettings.accepted&&!(null===(t=this.config)||void 0===t?void 0:t.blocking),this.shouldShowModal=!this._userSettings.accepted&&!!(null===(i=this.config)||void 0===i?void 0:i.blocking)}userSettingsChanged(){this._userSettings=l(this.userSettings)}async handleManagePrivacyClick(){this.shouldShowNotice=!0,this.shouldShowModal=!0,this.shouldShowNonmodal=!1}handleAcceptAllClick(){this._userSettings=Object.assign(Object.assign({},this._userSettings),{accepted:!0,functional:!0,performance:!0,targeting:!0}),this.hubUserPrivacySettingsChanged.emit(this._userSettings),this.shouldShowModal=!1,this.shouldShowNonmodal=!1}handleAcceptNecessaryClick(){this._userSettings=Object.assign(Object.assign({},this._userSettings),{accepted:!0,functional:!1,performance:!1,targeting:!1}),this.hubUserPrivacySettingsChanged.emit(this._userSettings),this.shouldShowModal=!1,this.shouldShowNonmodal=!1}handleViewSettingsClick(){this.shouldShowNotice=!1,this.shouldShowNonmodal=!1,this.shouldShowModal=!0}handleSettingsChange(t){t.stopPropagation(),this._userSettings=Object.assign(Object.assign({},this._userSettings),t.detail)}async handleConfirmClick(){this._userSettings=Object.assign(Object.assign({},this._userSettings),{accepted:!0}),this.hubUserPrivacySettingsChanged.emit(this._userSettings),this.shouldShowModal=!1,this.shouldShowNonmodal=!1}handleModalClose(){this.shouldShowModal=!1}handleNonmodalClose(){this.shouldShowNonmodal=!1}renderNotice(){return e(s,null,e("div",{slot:"header"},this.intl.t("notice.heading")),e("arcgis-privacy-consent",{config:this.config,intl:this.intl,slot:"content"}),e("calcite-button",{appearance:"outline",kind:"neutral",onClick:this.handleViewSettingsClick,slot:"back"},this.intl.t("notice.reviewSettingsButton")),e("calcite-button",{appearance:"outline",onClick:this.handleAcceptNecessaryClick,slot:"secondary"},this.intl.t("notice.acceptNecessaryButton")),e("calcite-button",{onClick:this.handleAcceptAllClick,slot:"primary"},this.intl.t("notice.acceptAllButton")))}renderSettings(){return e(s,null,e("div",{slot:"header"},this.intl.t("settings.heading")),e("arcgis-privacy-consent",{config:this.config,intl:this.intl,slot:"content"}),e("arcgis-privacy-settings",{esriTrackingEnabled:this.esriTrackingEnabled,intl:this.intl,onHubInternalUserPrivacySettingsChanged:this.handleSettingsChange,slot:"content",thirdPartyTrackingEnabled:this.thirdPartyTrackingEnabled,userSettings:this._userSettings}),e("calcite-button",{appearance:"solid",onClick:this.handleConfirmClick,slot:"primary"},this.intl.t("settings.confirmButton")))}renderModal(){const{shouldShowNotice:t}=this;return e("arcgis-wormhole",null,e("calcite-modal",{closeButtonDisabled:!0,docked:!0,escapeDisabled:!0,onCalciteModalClose:this.handleModalClose,open:this.shouldShowModal,outsideCloseDisabled:!0,scale:"s",width:t?"m":"s"},this.shouldShowNotice?this.renderNotice():this.renderSettings()))}renderNonmodal(){return e("arcgis-hub-nonmodal",Object.assign({},{onHubNonmodalClose:this.handleNonmodalClose,open:this.shouldShowNonmodal}),this.renderNotice())}renderButton(){return e("calcite-button",{appearance:"transparent",kind:"neutral",onClick:this.handleManagePrivacyClick,scale:"l"},this.intl.t("managePrivacyButton"))}_render(){if(this.shouldRender)return e(s,null,this.renderButton(),this.renderModal(),this.renderNonmodal())}render(){return e(n,{"data-element":"privacy-preferences"},this._render())}static get assetsDirs(){return["locales"]}get element(){return a(this)}static get watchers(){return{userSettings:["userSettingsChanged"]}}};r.style=":host{display:inline-block}";export{r as arcgis_privacy}