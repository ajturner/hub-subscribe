import{r as t,h as i,H as s,a as e}from"./p-d4ba4c14.js";import{i as a}from"./p-e4c1ab9e.js";import{d as r}from"./p-0e2acd85.js";import{i as o}from"./p-be5c5009.js";import{g as n}from"./p-69555c48.js";import{c as d}from"./p-b728aff4.js";import{p as l}from"./p-6dcae6cd.js";import"./p-dcdf7b57.js";import"./p-637ea136.js";import"./p-796574a4.js";const h=class{constructor(i){t(this,i),this.item=void 0,this.server=void 0,this.serverDefinition=void 0,this.layers=void 0,this.filterGeometry=void 0,this.layout="cards",this.authentication=void 0}handleDownloadSuccess(t){const{downloadUrl:i}=t.detail;r(i)}async componentWillLoad(){this.intl=await o.loadIntlForComponent(this.element),await this.loadServer()}async onItemUpdate(){await this.loadServer()}async onServerUpdate(){await this.loadServer()}async loadServer(){if(a(this.server))this.serverDefinition=await n({url:this.server,authentication:this.authentication}),this.serverDefinition.url=this.server;else if(this.server)this.serverDefinition=d(this.server);else if(this.item){const t=l(this.item.url);this.serverDefinition=await n({url:t,authentication:this.authentication}),this.serverDefinition.url=t}}get availableFormats(){var t,i;const s=(null===(t=this.serverDefinition)||void 0===t?void 0:t.capabilities)||"",e=(null===(i=this.serverDefinition)||void 0===i?void 0:i.supportedExportFormats)||"";return s.includes("Extract")?e.split(","):[]}renderCards(){return this.availableFormats.map((t=>i("arcgis-download-list-card",{authentication:this.authentication,class:"list-card",fileFormat:t,filterGeometry:this.filterGeometry,item:this.item,layers:this.layers,server:this.server})))}renderLinks(){return this.availableFormats.map((t=>i("div",{class:"format-link"},i("arcgis-download-features-button",{appearance:"transparent",authentication:this.authentication,fileFormat:t,filterGeometry:this.filterGeometry,item:this.item,layers:this.layers,server:this.server},this.intl.t(t)))))}renderDropdown(){return i("calcite-dropdown",null,i("calcite-button",{slot:"trigger"},this.intl.t("download")),i("calcite-dropdown-group",{"selection-mode":"none"},this.availableFormats.map((t=>i("calcite-dropdown-item",{class:"dropdown-option"},i("arcgis-download-features-button",{appearance:"transparent",authentication:this.authentication,fileFormat:t,filterGeometry:this.filterGeometry,item:this.item,layers:this.layers,server:this.server,width:"full"},this.intl.t(t)))))))}render(){let t;switch(this.layout){case"links":t=this.renderLinks();break;case"cards":t=this.renderCards();break;case"dropdown":t=this.renderDropdown()}return i(s,{"data-element":"download-list"},i("slot",null),i("div",null,t))}static get assetsDirs(){return["locales"]}get element(){return e(this)}static get watchers(){return{item:["onItemUpdate"],server:["onServerUpdate"]}}};h.style=":host{display:flex;flex-direction:column}.list-card:not(:first-child){margin-top:0.75rem}.format-link:not(:first-child){margin-top:0.75rem}.dropdown-option{width:100%}";export{h as arcgis_download_list}