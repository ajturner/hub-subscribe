import{r as t,c as e,h as a,H as s,a as i}from"./p-d4ba4c14.js";import{i as n}from"./p-be5c5009.js";import{b as h}from"./p-fd260f2d.js";import{d as r}from"./p-8cf4bd83.js";import"./p-dfe5a97d.js";const o=class{constructor(a){t(this,a),this.arcgisHubDateRangePickerSelect=e(this,"arcgisHubDateRangePickerSelect",7),this.hubTelemetry=e(this,"hubTelemetry",7),this.options=["today","yesterday","last7Days","last30Days","thisMonth","lastMonth","pastYear","custom"],this.value=void 0,this.min=void 0,this.max=void 0,this.selectedValue=void 0,this.customStartDate=void 0,this.customEndDate=void 0,h(this,"handleCalciteInputDatePickerRef")}handleSelectedValueChange(){(!this.isCustom||this.customStartDate&&this.customEndDate)&&(this.arcgisHubDateRangePickerSelect.emit({name:this.selectedValue,startDate:this.startDate,endDate:this.endDate}),this.hubTelemetry.emit(Object.assign(Object.assign({},r.dictionary.category.interaction.action.search.label.query),{details:this.selectedValue})))}handleCalciteDropdownOpen(){this.hubTelemetry.emit(Object.assign(Object.assign({},r.dictionary.category.interaction.action.open.label.dropdown),{details:"Date Range"}))}handleCalciteDrodownSelect(){this.selectedValue=this.dropdownEl.selectedItems[0].dataset.value}handleCalciteDatePickerRangeChange(){const[t,e]=this.calciteInputDatePickerEl.valueAsDate;t&&(this.customStartDate=t),e&&(this.customEndDate=e)}setDropdownEl(t){this.dropdownEl=t}get isCustom(){return"custom"===this.selectedValue}get startDate(){var t;return null===(t=this.dateRangeOptions[this.selectedValue])||void 0===t?void 0:t.startDate}get endDate(){var t;return(null===(t=this.dateRangeOptions[this.selectedValue])||void 0===t?void 0:t.endDate)||new Date}get dateRangeOptions(){const t=(new Date).getDate(),e=(new Date).getMonth();return{today:{startDate:new Date((new Date).setHours(0,0,0,0))},yesterday:{startDate:new Date(new Date((new Date).setDate(t-1)).setHours(0,0,0,0)),endDate:new Date(new Date((new Date).setDate(t-1)).setHours(23,59,59,999))},last7Days:{startDate:new Date((new Date).setDate(t-7))},last30Days:{startDate:new Date((new Date).setDate(t-30))},thisMonth:{startDate:new Date(new Date((new Date).setDate(1)).setHours(0,0,0,0))},lastMonth:{startDate:new Date(new Date(new Date((new Date).setMonth(e-1)).setDate(1)).setHours(0,0,0,0)),endDate:new Date(new Date((new Date).setDate(0)).setHours(23,59,59,999))},pastYear:{startDate:new Date(new Date((new Date).setMonth(e-12)).setDate(t+1))},custom:{startDate:this.customStartDate,endDate:this.customEndDate}}}get _messageOverrides(){return{nextMonth:this.intl.t("nextMonth"),prevMonth:this.intl.t("previousMonth"),year:this.intl.t("year")}}async componentWillLoad(){var t;this.intl=await n.loadIntlForComponent(this.element),"string"==typeof this.value?(this.selectedValue=this.value,this.isCustom&&(this.customStartDate=null,this.customEndDate=null)):(null===(t=this.value)||void 0===t?void 0:t.length)&&(this.selectedValue="custom",this.customStartDate=new Date(this.value[0]),this.customEndDate=new Date(this.value[1]))}handleCalciteInputDatePickerRef(t){if(this.calciteInputDatePickerEl=t,t&&t.shadowRoot&&!t.shadowRoot.querySelector("style[data-hub]")){const e=document.createElement("style");e.dataset.hub="",e.innerHTML=".menu-container { pointer-events: auto !important; }",t.shadowRoot.appendChild(e)}}get buttonText(){const{startDate:t,endDate:e}=this;return this.isCustom?null:`${this.intl.formatDate(t)} - ${this.intl.formatDate(e)}`}renderDropdown(){return a("calcite-dropdown",{ref:this.setDropdownEl.bind(this)},a("calcite-button",{appearance:"outline","icon-end":"chevron-down",kind:"neutral",round:!this.isCustom,slot:"trigger"},this.buttonText),a("calcite-dropdown-group",{"group-title":this.intl.t("title"),"selection-mode":"single"},Object.keys(this.dateRangeOptions).reduce(((t,e)=>(this.options.includes(e)&&t.push(a("calcite-dropdown-item",{"data-value":e,key:e,selected:e===this.selectedValue},this.intl.t(`${e}`))),t)),[])))}render(){return a(s,{"data-element":"date-range-picker"},this.isCustom&&a("calcite-input-date-picker",{lang:this.intl.locale,max:this.max,messageOverrides:this._messageOverrides,min:this.min,range:!0,ref:this.handleCalciteInputDatePickerRef,role:"application",valueAsDate:[this.customStartDate,this.customEndDate]}),this.renderDropdown())}static get assetsDirs(){return["locales"]}get element(){return i(this)}static get watchers(){return{selectedValue:["handleSelectedValueChange"],customStartDate:["handleSelectedValueChange"],customEndDate:["handleSelectedValueChange"]}}};o.style=":host{display:flex}:host calcite-input-date-picker{width:auto}";export{o as arcgis_hub_date_range_picker}